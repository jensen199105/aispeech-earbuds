#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "AISP_TSL_base.h"
#include "AISP_TSL_fft.h"
#include "AISP_TSL_common.h"
#include "aisp_memmng.h"

#ifdef USE_HIFI4_OPTIMIZE
#include "NatureDSP_Signal.h"
#endif

#ifndef AISP_TSL_NFFT
#define AISP_TSL_NFFT (1024)
#endif

#ifndef JL_AEC_OPTIMIZATION_FFT
#ifndef USE_HIFI4_OPTIMIZE
#if (AISP_TSL_NFFT == 1024)
const aisp_cpx_s16_t twiddles_tab_1024[512] =
{
#ifdef AISPEECH_FIXED
    { 16384,      0}, { 16383,   -201}, { 16379,   -402}, { 16373,   -603}, { 16364,   -804}, { 16353,  -1005}, { 16340,  -1205}, { 16324,  -1406},
    { 16305,  -1606}, { 16284,  -1806}, { 16261,  -2006}, { 16235,  -2205}, { 16207,  -2404}, { 16176,  -2603}, { 16143,  -2801}, { 16107,  -2999},
    { 16069,  -3196}, { 16029,  -3393}, { 15986,  -3590}, { 15941,  -3786}, { 15893,  -3981}, { 15843,  -4176}, { 15791,  -4370}, { 15736,  -4563},
    { 15679,  -4756}, { 15619,  -4948}, { 15557,  -5139}, { 15493,  -5330}, { 15426,  -5520}, { 15357,  -5708}, { 15286,  -5897}, { 15213,  -6084},
    { 15137,  -6270}, { 15059,  -6455}, { 14978,  -6639}, { 14896,  -6823}, { 14811,  -7005}, { 14724,  -7186}, { 14635,  -7366}, { 14543,  -7545},
    { 14449,  -7723}, { 14354,  -7900}, { 14256,  -8076}, { 14155,  -8250}, { 14053,  -8423}, { 13949,  -8595}, { 13842,  -8765}, { 13733,  -8935},
    { 13623,  -9102}, { 13510,  -9269}, { 13395,  -9434}, { 13279,  -9598}, { 13160,  -9760}, { 13039,  -9921}, { 12916, -10080}, { 12792, -10238},
    { 12665, -10394}, { 12537, -10549}, { 12406, -10702}, { 12274, -10853}, { 12140, -11003}, { 12004, -11151}, { 11866, -11297}, { 11727, -11442},
    { 11585, -11585}, { 11442, -11727}, { 11297, -11866}, { 11151, -12004}, { 11003, -12140}, { 10853, -12274}, { 10702, -12406}, { 10549, -12537},
    { 10394, -12665}, { 10238, -12792}, { 10080, -12916}, {  9921, -13039}, {  9760, -13160}, {  9598, -13279}, {  9434, -13395}, {  9269, -13510},
    {  9102, -13623}, {  8935, -13733}, {  8765, -13842}, {  8595, -13949}, {  8423, -14053}, {  8250, -14155}, {  8076, -14256}, {  7900, -14354},
    {  7723, -14449}, {  7545, -14543}, {  7366, -14635}, {  7186, -14724}, {  7005, -14811}, {  6823, -14896}, {  6639, -14978}, {  6455, -15059},
    {  6270, -15137}, {  6084, -15213}, {  5897, -15286}, {  5708, -15357}, {  5520, -15426}, {  5330, -15493}, {  5139, -15557}, {  4948, -15619},
    {  4756, -15679}, {  4563, -15736}, {  4370, -15791}, {  4176, -15843}, {  3981, -15893}, {  3786, -15941}, {  3590, -15986}, {  3393, -16029},
    {  3196, -16069}, {  2999, -16107}, {  2801, -16143}, {  2603, -16176}, {  2404, -16207}, {  2205, -16235}, {  2006, -16261}, {  1806, -16284},
    {  1606, -16305}, {  1406, -16324}, {  1205, -16340}, {  1005, -16353}, {   804, -16364}, {   603, -16373}, {   402, -16379}, {   201, -16383},
    {     0, -16384}, {  -201, -16383}, {  -402, -16379}, {  -603, -16373}, {  -804, -16364}, { -1005, -16353}, { -1205, -16340}, { -1406, -16324},
    { -1606, -16305}, { -1806, -16284}, { -2006, -16261}, { -2205, -16235}, { -2404, -16207}, { -2603, -16176}, { -2801, -16143}, { -2999, -16107},
    { -3196, -16069}, { -3393, -16029}, { -3590, -15986}, { -3786, -15941}, { -3981, -15893}, { -4176, -15843}, { -4370, -15791}, { -4563, -15736},
    { -4756, -15679}, { -4948, -15619}, { -5139, -15557}, { -5330, -15493}, { -5520, -15426}, { -5708, -15357}, { -5897, -15286}, { -6084, -15213},
    { -6270, -15137}, { -6455, -15059}, { -6639, -14978}, { -6823, -14896}, { -7005, -14811}, { -7186, -14724}, { -7366, -14635}, { -7545, -14543},
    { -7723, -14449}, { -7900, -14354}, { -8076, -14256}, { -8250, -14155}, { -8423, -14053}, { -8595, -13949}, { -8765, -13842}, { -8935, -13733},
    { -9102, -13623}, { -9269, -13510}, { -9434, -13395}, { -9598, -13279}, { -9760, -13160}, { -9921, -13039}, { -10080, -12916}, { -10238, -12792},
    { -10394, -12665}, { -10549, -12537}, { -10702, -12406}, { -10853, -12274}, { -11003, -12140}, { -11151, -12004}, { -11297, -11866}, { -11442, -11727},
    { -11585, -11585}, { -11727, -11442}, { -11866, -11297}, { -12004, -11151}, { -12140, -11003}, { -12274, -10853}, { -12406, -10702}, { -12537, -10549},
    { -12665, -10394}, { -12792, -10238}, { -12916, -10080}, { -13039,  -9921}, { -13160,  -9760}, { -13279,  -9598}, { -13395,  -9434}, { -13510,  -9269},
    { -13623,  -9102}, { -13733,  -8935}, { -13842,  -8765}, { -13949,  -8595}, { -14053,  -8423}, { -14155,  -8250}, { -14256,  -8076}, { -14354,  -7900},
    { -14449,  -7723}, { -14543,  -7545}, { -14635,  -7366}, { -14724,  -7186}, { -14811,  -7005}, { -14896,  -6823}, { -14978,  -6639}, { -15059,  -6455},
    { -15137,  -6270}, { -15213,  -6084}, { -15286,  -5897}, { -15357,  -5708}, { -15426,  -5520}, { -15493,  -5330}, { -15557,  -5139}, { -15619,  -4948},
    { -15679,  -4756}, { -15736,  -4563}, { -15791,  -4370}, { -15843,  -4176}, { -15893,  -3981}, { -15941,  -3786}, { -15986,  -3590}, { -16029,  -3393},
    { -16069,  -3196}, { -16107,  -2999}, { -16143,  -2801}, { -16176,  -2603}, { -16207,  -2404}, { -16235,  -2205}, { -16261,  -2006}, { -16284,  -1806},
    { -16305,  -1606}, { -16324,  -1406}, { -16340,  -1205}, { -16353,  -1005}, { -16364,   -804}, { -16373,   -603}, { -16379,   -402}, { -16383,   -201},
    { -16384,      0}, { -16383,    201}, { -16379,    402}, { -16373,    603}, { -16364,    804}, { -16353,   1005}, { -16340,   1205}, { -16324,   1406},
    { -16305,   1606}, { -16284,   1806}, { -16261,   2006}, { -16235,   2205}, { -16207,   2404}, { -16176,   2603}, { -16143,   2801}, { -16107,   2999},
    { -16069,   3196}, { -16029,   3393}, { -15986,   3590}, { -15941,   3786}, { -15893,   3981}, { -15843,   4176}, { -15791,   4370}, { -15736,   4563},
    { -15679,   4756}, { -15619,   4948}, { -15557,   5139}, { -15493,   5330}, { -15426,   5520}, { -15357,   5708}, { -15286,   5897}, { -15213,   6084},
    { -15137,   6270}, { -15059,   6455}, { -14978,   6639}, { -14896,   6823}, { -14811,   7005}, { -14724,   7186}, { -14635,   7366}, { -14543,   7545},
    { -14449,   7723}, { -14354,   7900}, { -14256,   8076}, { -14155,   8250}, { -14053,   8423}, { -13949,   8595}, { -13842,   8765}, { -13733,   8935},
    { -13623,   9102}, { -13510,   9269}, { -13395,   9434}, { -13279,   9598}, { -13160,   9760}, { -13039,   9921}, { -12916,  10080}, { -12792,  10238},
    { -12665,  10394}, { -12537,  10549}, { -12406,  10702}, { -12274,  10853}, { -12140,  11003}, { -12004,  11151}, { -11866,  11297}, { -11727,  11442},
    { -11585,  11585}, { -11442,  11727}, { -11297,  11866}, { -11151,  12004}, { -11003,  12140}, { -10853,  12274}, { -10702,  12406}, { -10549,  12537},
    { -10394,  12665}, { -10238,  12792}, { -10080,  12916}, { -9921,  13039}, { -9760,  13160}, { -9598,  13279}, { -9434,  13395}, { -9269,  13510},
    { -9102,  13623}, { -8935,  13733}, { -8765,  13842}, { -8595,  13949}, { -8423,  14053}, { -8250,  14155}, { -8076,  14256}, { -7900,  14354},
    { -7723,  14449}, { -7545,  14543}, { -7366,  14635}, { -7186,  14724}, { -7005,  14811}, { -6823,  14896}, { -6639,  14978}, { -6455,  15059},
    { -6270,  15137}, { -6084,  15213}, { -5897,  15286}, { -5708,  15357}, { -5520,  15426}, { -5330,  15493}, { -5139,  15557}, { -4948,  15619},
    { -4756,  15679}, { -4563,  15736}, { -4370,  15791}, { -4176,  15843}, { -3981,  15893}, { -3786,  15941}, { -3590,  15986}, { -3393,  16029},
    { -3196,  16069}, { -2999,  16107}, { -2801,  16143}, { -2603,  16176}, { -2404,  16207}, { -2205,  16235}, { -2006,  16261}, { -1806,  16284},
    { -1606,  16305}, { -1406,  16324}, { -1205,  16340}, { -1005,  16353}, {  -804,  16364}, {  -603,  16373}, {  -402,  16379}, {  -201,  16383},
    {     0,  16384}, {   201,  16383}, {   402,  16379}, {   603,  16373}, {   804,  16364}, {  1005,  16353}, {  1205,  16340}, {  1406,  16324},
    {  1606,  16305}, {  1806,  16284}, {  2006,  16261}, {  2205,  16235}, {  2404,  16207}, {  2603,  16176}, {  2801,  16143}, {  2999,  16107},
    {  3196,  16069}, {  3393,  16029}, {  3590,  15986}, {  3786,  15941}, {  3981,  15893}, {  4176,  15843}, {  4370,  15791}, {  4563,  15736},
    {  4756,  15679}, {  4948,  15619}, {  5139,  15557}, {  5330,  15493}, {  5520,  15426}, {  5708,  15357}, {  5897,  15286}, {  6084,  15213},
    {  6270,  15137}, {  6455,  15059}, {  6639,  14978}, {  6823,  14896}, {  7005,  14811}, {  7186,  14724}, {  7366,  14635}, {  7545,  14543},
    {  7723,  14449}, {  7900,  14354}, {  8076,  14256}, {  8250,  14155}, {  8423,  14053}, {  8595,  13949}, {  8765,  13842}, {  8935,  13733},
    {  9102,  13623}, {  9269,  13510}, {  9434,  13395}, {  9598,  13279}, {  9760,  13160}, {  9921,  13039}, { 10080,  12916}, { 10238,  12792},
    { 10394,  12665}, { 10549,  12537}, { 10702,  12406}, { 10853,  12274}, { 11003,  12140}, { 11151,  12004}, { 11297,  11866}, { 11442,  11727},
    { 11585,  11585}, { 11727,  11442}, { 11866,  11297}, { 12004,  11151}, { 12140,  11003}, { 12274,  10853}, { 12406,  10702}, { 12537,  10549},
    { 12665,  10394}, { 12792,  10238}, { 12916,  10080}, { 13039,   9921}, { 13160,   9760}, { 13279,   9598}, { 13395,   9434}, { 13510,   9269},
    { 13623,   9102}, { 13733,   8935}, { 13842,   8765}, { 13949,   8595}, { 14053,   8423}, { 14155,   8250}, { 14256,   8076}, { 14354,   7900},
    { 14449,   7723}, { 14543,   7545}, { 14635,   7366}, { 14724,   7186}, { 14811,   7005}, { 14896,   6823}, { 14978,   6639}, { 15059,   6455},
    { 15137,   6270}, { 15213,   6084}, { 15286,   5897}, { 15357,   5708}, { 15426,   5520}, { 15493,   5330}, { 15557,   5139}, { 15619,   4948},
    { 15679,   4756}, { 15736,   4563}, { 15791,   4370}, { 15843,   4176}, { 15893,   3981}, { 15941,   3786}, { 15986,   3590}, { 16029,   3393},
    { 16069,   3196}, { 16107,   2999}, { 16143,   2801}, { 16176,   2603}, { 16207,   2404}, { 16235,   2205}, { 16261,   2006}, { 16284,   1806},
    { 16305,   1606}, { 16324,   1406}, { 16340,   1205}, { 16353,   1005}, { 16364,    804}, { 16373,    603}, { 16379,    402}, { 16383,    201}
#else
    { 1.00000000,  0.00000000}, { 0.99992470, -0.01227154}, { 0.99969882, -0.02454123}, { 0.99932238, -0.03680722},
    { 0.99879546, -0.04906767}, { 0.99811811, -0.06132074}, { 0.99729046, -0.07356456}, { 0.99631261, -0.08579731},
    { 0.99518473, -0.09801714}, { 0.99390697, -0.11022221}, { 0.99247953, -0.12241068}, { 0.99090264, -0.13458071},
    { 0.98917651, -0.14673047}, { 0.98730142, -0.15885814}, { 0.98527764, -0.17096189}, { 0.98310549, -0.18303989},
    { 0.98078528, -0.19509032}, { 0.97831737, -0.20711138}, { 0.97570213, -0.21910124}, { 0.97293995, -0.23105811},
    { 0.97003125, -0.24298018}, { 0.96697647, -0.25486566}, { 0.96377607, -0.26671276}, { 0.96043052, -0.27851969},
    { 0.95694034, -0.29028468}, { 0.95330604, -0.30200595}, { 0.94952818, -0.31368174}, { 0.94560733, -0.32531029},
    { 0.94154407, -0.33688985}, { 0.93733901, -0.34841868}, { 0.93299280, -0.35989504}, { 0.92850608, -0.37131719},
    { 0.92387953, -0.38268343}, { 0.91911385, -0.39399204}, { 0.91420976, -0.40524131}, { 0.90916798, -0.41642956},
    { 0.90398929, -0.42755509}, { 0.89867447, -0.43861624}, { 0.89322430, -0.44961133}, { 0.88763962, -0.46053871},
    { 0.88192126, -0.47139674}, { 0.87607009, -0.48218377}, { 0.87008699, -0.49289819}, { 0.86397286, -0.50353838},
    { 0.85772861, -0.51410274}, { 0.85135519, -0.52458968}, { 0.84485357, -0.53499762}, { 0.83822471, -0.54532499},
    { 0.83146961, -0.55557023}, { 0.82458930, -0.56573181}, { 0.81758481, -0.57580819}, { 0.81045720, -0.58579786},
    { 0.80320753, -0.59569930}, { 0.79583690, -0.60551104}, { 0.78834643, -0.61523159}, { 0.78073723, -0.62485949},
    { 0.77301045, -0.63439328}, { 0.76516727, -0.64383154}, { 0.75720885, -0.65317284}, { 0.74913639, -0.66241578},
    { 0.74095113, -0.67155895}, { 0.73265427, -0.68060100}, { 0.72424708, -0.68954054}, { 0.71573083, -0.69837625},
    { 0.70710678, -0.70710678}, { 0.69837625, -0.71573083}, { 0.68954054, -0.72424708}, { 0.68060100, -0.73265427},
    { 0.67155895, -0.74095113}, { 0.66241578, -0.74913639}, { 0.65317284, -0.75720885}, { 0.64383154, -0.76516727},
    { 0.63439328, -0.77301045}, { 0.62485949, -0.78073723}, { 0.61523159, -0.78834643}, { 0.60551104, -0.79583690},
    { 0.59569930, -0.80320753}, { 0.58579786, -0.81045720}, { 0.57580819, -0.81758481}, { 0.56573181, -0.82458930},
    { 0.55557023, -0.83146961}, { 0.54532499, -0.83822471}, { 0.53499762, -0.84485357}, { 0.52458968, -0.85135519},
    { 0.51410274, -0.85772861}, { 0.50353838, -0.86397286}, { 0.49289819, -0.87008699}, { 0.48218377, -0.87607009},
    { 0.47139674, -0.88192126}, { 0.46053871, -0.88763962}, { 0.44961133, -0.89322430}, { 0.43861624, -0.89867447},
    { 0.42755509, -0.90398929}, { 0.41642956, -0.90916798}, { 0.40524131, -0.91420976}, { 0.39399204, -0.91911385},
    { 0.38268343, -0.92387953}, { 0.37131719, -0.92850608}, { 0.35989504, -0.93299280}, { 0.34841868, -0.93733901},
    { 0.33688985, -0.94154407}, { 0.32531029, -0.94560733}, { 0.31368174, -0.94952818}, { 0.30200595, -0.95330604},
    { 0.29028468, -0.95694034}, { 0.27851969, -0.96043052}, { 0.26671276, -0.96377607}, { 0.25486566, -0.96697647},
    { 0.24298018, -0.97003125}, { 0.23105811, -0.97293995}, { 0.21910124, -0.97570213}, { 0.20711138, -0.97831737},
    { 0.19509032, -0.98078528}, { 0.18303989, -0.98310549}, { 0.17096189, -0.98527764}, { 0.15885814, -0.98730142},
    { 0.14673047, -0.98917651}, { 0.13458071, -0.99090264}, { 0.12241068, -0.99247953}, { 0.11022221, -0.99390697},
    { 0.09801714, -0.99518473}, { 0.08579731, -0.99631261}, { 0.07356456, -0.99729046}, { 0.06132074, -0.99811811},
    { 0.04906767, -0.99879546}, { 0.03680722, -0.99932238}, { 0.02454123, -0.99969882}, { 0.01227154, -0.99992470},
    { 0.00000000, -1.00000000}, { -0.01227154, -0.99992470}, { -0.02454123, -0.99969882}, { -0.03680722, -0.99932238},
    { -0.04906767, -0.99879546}, { -0.06132074, -0.99811811}, { -0.07356456, -0.99729046}, { -0.08579731, -0.99631261},
    { -0.09801714, -0.99518473}, { -0.11022221, -0.99390697}, { -0.12241068, -0.99247953}, { -0.13458071, -0.99090264},
    { -0.14673047, -0.98917651}, { -0.15885814, -0.98730142}, { -0.17096189, -0.98527764}, { -0.18303989, -0.98310549},
    { -0.19509032, -0.98078528}, { -0.20711138, -0.97831737}, { -0.21910124, -0.97570213}, { -0.23105811, -0.97293995},
    { -0.24298018, -0.97003125}, { -0.25486566, -0.96697647}, { -0.26671276, -0.96377607}, { -0.27851969, -0.96043052},
    { -0.29028468, -0.95694034}, { -0.30200595, -0.95330604}, { -0.31368174, -0.94952818}, { -0.32531029, -0.94560733},
    { -0.33688985, -0.94154407}, { -0.34841868, -0.93733901}, { -0.35989504, -0.93299280}, { -0.37131719, -0.92850608},
    { -0.38268343, -0.92387953}, { -0.39399204, -0.91911385}, { -0.40524131, -0.91420976}, { -0.41642956, -0.90916798},
    { -0.42755509, -0.90398929}, { -0.43861624, -0.89867447}, { -0.44961133, -0.89322430}, { -0.46053871, -0.88763962},
    { -0.47139674, -0.88192126}, { -0.48218377, -0.87607009}, { -0.49289819, -0.87008699}, { -0.50353838, -0.86397286},
    { -0.51410274, -0.85772861}, { -0.52458968, -0.85135519}, { -0.53499762, -0.84485357}, { -0.54532499, -0.83822471},
    { -0.55557023, -0.83146961}, { -0.56573181, -0.82458930}, { -0.57580819, -0.81758481}, { -0.58579786, -0.81045720},
    { -0.59569930, -0.80320753}, { -0.60551104, -0.79583690}, { -0.61523159, -0.78834643}, { -0.62485949, -0.78073723},
    { -0.63439328, -0.77301045}, { -0.64383154, -0.76516727}, { -0.65317284, -0.75720885}, { -0.66241578, -0.74913639},
    { -0.67155895, -0.74095113}, { -0.68060100, -0.73265427}, { -0.68954054, -0.72424708}, { -0.69837625, -0.71573083},
    { -0.70710678, -0.70710678}, { -0.71573083, -0.69837625}, { -0.72424708, -0.68954054}, { -0.73265427, -0.68060100},
    { -0.74095113, -0.67155895}, { -0.74913639, -0.66241578}, { -0.75720885, -0.65317284}, { -0.76516727, -0.64383154},
    { -0.77301045, -0.63439328}, { -0.78073723, -0.62485949}, { -0.78834643, -0.61523159}, { -0.79583690, -0.60551104},
    { -0.80320753, -0.59569930}, { -0.81045720, -0.58579786}, { -0.81758481, -0.57580819}, { -0.82458930, -0.56573181},
    { -0.83146961, -0.55557023}, { -0.83822471, -0.54532499}, { -0.84485357, -0.53499762}, { -0.85135519, -0.52458968},
    { -0.85772861, -0.51410274}, { -0.86397286, -0.50353838}, { -0.87008699, -0.49289819}, { -0.87607009, -0.48218377},
    { -0.88192126, -0.47139674}, { -0.88763962, -0.46053871}, { -0.89322430, -0.44961133}, { -0.89867447, -0.43861624},
    { -0.90398929, -0.42755509}, { -0.90916798, -0.41642956}, { -0.91420976, -0.40524131}, { -0.91911385, -0.39399204},
    { -0.92387953, -0.38268343}, { -0.92850608, -0.37131719}, { -0.93299280, -0.35989504}, { -0.93733901, -0.34841868},
    { -0.94154407, -0.33688985}, { -0.94560733, -0.32531029}, { -0.94952818, -0.31368174}, { -0.95330604, -0.30200595},
    { -0.95694034, -0.29028468}, { -0.96043052, -0.27851969}, { -0.96377607, -0.26671276}, { -0.96697647, -0.25486566},
    { -0.97003125, -0.24298018}, { -0.97293995, -0.23105811}, { -0.97570213, -0.21910124}, { -0.97831737, -0.20711138},
    { -0.98078528, -0.19509032}, { -0.98310549, -0.18303989}, { -0.98527764, -0.17096189}, { -0.98730142, -0.15885814},
    { -0.98917651, -0.14673047}, { -0.99090264, -0.13458071}, { -0.99247953, -0.12241068}, { -0.99390697, -0.11022221},
    { -0.99518473, -0.09801714}, { -0.99631261, -0.08579731}, { -0.99729046, -0.07356456}, { -0.99811811, -0.06132074},
    { -0.99879546, -0.04906767}, { -0.99932238, -0.03680722}, { -0.99969882, -0.02454123}, { -0.99992470, -0.01227154},
    { -1.00000000, -0.00000000}, { -0.99992470,  0.01227154}, { -0.99969882,  0.02454123}, { -0.99932238,  0.03680722},
    { -0.99879546,  0.04906767}, { -0.99811811,  0.06132074}, { -0.99729046,  0.07356456}, { -0.99631261,  0.08579731},
    { -0.99518473,  0.09801714}, { -0.99390697,  0.11022221}, { -0.99247953,  0.12241068}, { -0.99090264,  0.13458071},
    { -0.98917651,  0.14673047}, { -0.98730142,  0.15885814}, { -0.98527764,  0.17096189}, { -0.98310549,  0.18303989},
    { -0.98078528,  0.19509032}, { -0.97831737,  0.20711138}, { -0.97570213,  0.21910124}, { -0.97293995,  0.23105811},
    { -0.97003125,  0.24298018}, { -0.96697647,  0.25486566}, { -0.96377607,  0.26671276}, { -0.96043052,  0.27851969},
    { -0.95694034,  0.29028468}, { -0.95330604,  0.30200595}, { -0.94952818,  0.31368174}, { -0.94560733,  0.32531029},
    { -0.94154407,  0.33688985}, { -0.93733901,  0.34841868}, { -0.93299280,  0.35989504}, { -0.92850608,  0.37131719},
    { -0.92387953,  0.38268343}, { -0.91911385,  0.39399204}, { -0.91420976,  0.40524131}, { -0.90916798,  0.41642956},
    { -0.90398929,  0.42755509}, { -0.89867447,  0.43861624}, { -0.89322430,  0.44961133}, { -0.88763962,  0.46053871},
    { -0.88192126,  0.47139674}, { -0.87607009,  0.48218377}, { -0.87008699,  0.49289819}, { -0.86397286,  0.50353838},
    { -0.85772861,  0.51410274}, { -0.85135519,  0.52458968}, { -0.84485357,  0.53499762}, { -0.83822471,  0.54532499},
    { -0.83146961,  0.55557023}, { -0.82458930,  0.56573181}, { -0.81758481,  0.57580819}, { -0.81045720,  0.58579786},
    { -0.80320753,  0.59569930}, { -0.79583690,  0.60551104}, { -0.78834643,  0.61523159}, { -0.78073723,  0.62485949},
    { -0.77301045,  0.63439328}, { -0.76516727,  0.64383154}, { -0.75720885,  0.65317284}, { -0.74913639,  0.66241578},
    { -0.74095113,  0.67155895}, { -0.73265427,  0.68060100}, { -0.72424708,  0.68954054}, { -0.71573083,  0.69837625},
    { -0.70710678,  0.70710678}, { -0.69837625,  0.71573083}, { -0.68954054,  0.72424708}, { -0.68060100,  0.73265427},
    { -0.67155895,  0.74095113}, { -0.66241578,  0.74913639}, { -0.65317284,  0.75720885}, { -0.64383154,  0.76516727},
    { -0.63439328,  0.77301045}, { -0.62485949,  0.78073723}, { -0.61523159,  0.78834643}, { -0.60551104,  0.79583690},
    { -0.59569930,  0.80320753}, { -0.58579786,  0.81045720}, { -0.57580819,  0.81758481}, { -0.56573181,  0.82458930},
    { -0.55557023,  0.83146961}, { -0.54532499,  0.83822471}, { -0.53499762,  0.84485357}, { -0.52458968,  0.85135519},
    { -0.51410274,  0.85772861}, { -0.50353838,  0.86397286}, { -0.49289819,  0.87008699}, { -0.48218377,  0.87607009},
    { -0.47139674,  0.88192126}, { -0.46053871,  0.88763962}, { -0.44961133,  0.89322430}, { -0.43861624,  0.89867447},
    { -0.42755509,  0.90398929}, { -0.41642956,  0.90916798}, { -0.40524131,  0.91420976}, { -0.39399204,  0.91911385},
    { -0.38268343,  0.92387953}, { -0.37131719,  0.92850608}, { -0.35989504,  0.93299280}, { -0.34841868,  0.93733901},
    { -0.33688985,  0.94154407}, { -0.32531029,  0.94560733}, { -0.31368174,  0.94952818}, { -0.30200595,  0.95330604},
    { -0.29028468,  0.95694034}, { -0.27851969,  0.96043052}, { -0.26671276,  0.96377607}, { -0.25486566,  0.96697647},
    { -0.24298018,  0.97003125}, { -0.23105811,  0.97293995}, { -0.21910124,  0.97570213}, { -0.20711138,  0.97831737},
    { -0.19509032,  0.98078528}, { -0.18303989,  0.98310549}, { -0.17096189,  0.98527764}, { -0.15885814,  0.98730142},
    { -0.14673047,  0.98917651}, { -0.13458071,  0.99090264}, { -0.12241068,  0.99247953}, { -0.11022221,  0.99390697},
    { -0.09801714,  0.99518473}, { -0.08579731,  0.99631261}, { -0.07356456,  0.99729046}, { -0.06132074,  0.99811811},
    { -0.04906767,  0.99879546}, { -0.03680722,  0.99932238}, { -0.02454123,  0.99969882}, { -0.01227154,  0.99992470},
    { -0.00000000,  1.00000000}, { 0.01227154,  0.99992470}, { 0.02454123,  0.99969882}, { 0.03680722,  0.99932238},
    { 0.04906767,  0.99879546}, { 0.06132074,  0.99811811}, { 0.07356456,  0.99729046}, { 0.08579731,  0.99631261},
    { 0.09801714,  0.99518473}, { 0.11022221,  0.99390697}, { 0.12241068,  0.99247953}, { 0.13458071,  0.99090264},
    { 0.14673047,  0.98917651}, { 0.15885814,  0.98730142}, { 0.17096189,  0.98527764}, { 0.18303989,  0.98310549},
    { 0.19509032,  0.98078528}, { 0.20711138,  0.97831737}, { 0.21910124,  0.97570213}, { 0.23105811,  0.97293995},
    { 0.24298018,  0.97003125}, { 0.25486566,  0.96697647}, { 0.26671276,  0.96377607}, { 0.27851969,  0.96043052},
    { 0.29028468,  0.95694034}, { 0.30200595,  0.95330604}, { 0.31368174,  0.94952818}, { 0.32531029,  0.94560733},
    { 0.33688985,  0.94154407}, { 0.34841868,  0.93733901}, { 0.35989504,  0.93299280}, { 0.37131719,  0.92850608},
    { 0.38268343,  0.92387953}, { 0.39399204,  0.91911385}, { 0.40524131,  0.91420976}, { 0.41642956,  0.90916798},
    { 0.42755509,  0.90398929}, { 0.43861624,  0.89867447}, { 0.44961133,  0.89322430}, { 0.46053871,  0.88763962},
    { 0.47139674,  0.88192126}, { 0.48218377,  0.87607009}, { 0.49289819,  0.87008699}, { 0.50353838,  0.86397286},
    { 0.51410274,  0.85772861}, { 0.52458968,  0.85135519}, { 0.53499762,  0.84485357}, { 0.54532499,  0.83822471},
    { 0.55557023,  0.83146961}, { 0.56573181,  0.82458930}, { 0.57580819,  0.81758481}, { 0.58579786,  0.81045720},
    { 0.59569930,  0.80320753}, { 0.60551104,  0.79583690}, { 0.61523159,  0.78834643}, { 0.62485949,  0.78073723},
    { 0.63439328,  0.77301045}, { 0.64383154,  0.76516727}, { 0.65317284,  0.75720885}, { 0.66241578,  0.74913639},
    { 0.67155895,  0.74095113}, { 0.68060100,  0.73265427}, { 0.68954054,  0.72424708}, { 0.69837625,  0.71573083},
    { 0.70710678,  0.70710678}, { 0.71573083,  0.69837625}, { 0.72424708,  0.68954054}, { 0.73265427,  0.68060100},
    { 0.74095113,  0.67155895}, { 0.74913639,  0.66241578}, { 0.75720885,  0.65317284}, { 0.76516727,  0.64383154},
    { 0.77301045,  0.63439328}, { 0.78073723,  0.62485949}, { 0.78834643,  0.61523159}, { 0.79583690,  0.60551104},
    { 0.80320753,  0.59569930}, { 0.81045720,  0.58579786}, { 0.81758481,  0.57580819}, { 0.82458930,  0.56573181},
    { 0.83146961,  0.55557023}, { 0.83822471,  0.54532499}, { 0.84485357,  0.53499762}, { 0.85135519,  0.52458968},
    { 0.85772861,  0.51410274}, { 0.86397286,  0.50353838}, { 0.87008699,  0.49289819}, { 0.87607009,  0.48218377},
    { 0.88192126,  0.47139674}, { 0.88763962,  0.46053871}, { 0.89322430,  0.44961133}, { 0.89867447,  0.43861624},
    { 0.90398929,  0.42755509}, { 0.90916798,  0.41642956}, { 0.91420976,  0.40524131}, { 0.91911385,  0.39399204},
    { 0.92387953,  0.38268343}, { 0.92850608,  0.37131719}, { 0.93299280,  0.35989504}, { 0.93733901,  0.34841868},
    { 0.94154407,  0.33688985}, { 0.94560733,  0.32531029}, { 0.94952818,  0.31368174}, { 0.95330604,  0.30200595},
    { 0.95694034,  0.29028468}, { 0.96043052,  0.27851969}, { 0.96377607,  0.26671276}, { 0.96697647,  0.25486566},
    { 0.97003125,  0.24298018}, { 0.97293995,  0.23105811}, { 0.97570213,  0.21910124}, { 0.97831737,  0.20711138},
    { 0.98078528,  0.19509032}, { 0.98310549,  0.18303989}, { 0.98527764,  0.17096189}, { 0.98730142,  0.15885814},
    { 0.98917651,  0.14673047}, { 0.99090264,  0.13458071}, { 0.99247953,  0.12241068}, { 0.99390697,  0.11022221},
    { 0.99518473,  0.09801714}, { 0.99631261,  0.08579731}, { 0.99729046,  0.07356456}, { 0.99811811,  0.06132074},
    { 0.99879546,  0.04906767}, { 0.99932238,  0.03680722}, { 0.99969882,  0.02454123}, { 0.99992470,  0.01227154}
#endif
};

const aisp_cpx_s16_t super_twiddles_1024[512] =
{
#ifdef AISPEECH_FIXED
    {     0, -16384}, {  -101, -16384}, {  -201, -16383}, {  -302, -16381}, {  -402, -16379}, {  -503, -16376}, {  -603, -16373}, {  -704, -16369},
    {  -804, -16364}, {  -904, -16359}, { -1005, -16353}, { -1105, -16347}, { -1205, -16340}, { -1306, -16332}, { -1406, -16324}, { -1506, -16315},
    { -1606, -16305}, { -1706, -16295}, { -1806, -16284}, { -1906, -16273}, { -2006, -16261}, { -2105, -16248}, { -2205, -16235}, { -2305, -16221},
    { -2404, -16207}, { -2503, -16192}, { -2603, -16176}, { -2702, -16160}, { -2801, -16143}, { -2900, -16125}, { -2999, -16107}, { -3098, -16088},
    { -3196, -16069}, { -3295, -16049}, { -3393, -16029}, { -3492, -16008}, { -3590, -15986}, { -3688, -15964}, { -3786, -15941}, { -3883, -15917},
    { -3981, -15893}, { -4078, -15868}, { -4176, -15843}, { -4273, -15817}, { -4370, -15791}, { -4467, -15763}, { -4563, -15736}, { -4660, -15707},
    { -4756, -15679}, { -4852, -15649}, { -4948, -15619}, { -5044, -15588}, { -5139, -15557}, { -5235, -15525}, { -5330, -15493}, { -5425, -15460},
    { -5520, -15426}, { -5614, -15392}, { -5708, -15357}, { -5803, -15322}, { -5897, -15286}, { -5990, -15250}, { -6084, -15213}, { -6177, -15175},
    { -6270, -15137}, { -6363, -15098}, { -6455, -15059}, { -6547, -15019}, { -6639, -14978}, { -6731, -14937}, { -6823, -14896}, { -6914, -14854},
    { -7005, -14811}, { -7096, -14768}, { -7186, -14724}, { -7276, -14680}, { -7366, -14635}, { -7456, -14589}, { -7545, -14543}, { -7635, -14497},
    { -7723, -14449}, { -7812, -14402}, { -7900, -14354}, { -7988, -14305}, { -8076, -14256}, { -8163, -14206}, { -8250, -14155}, { -8337, -14104},
    { -8423, -14053}, { -8509, -14001}, { -8595, -13949}, { -8680, -13896}, { -8765, -13842}, { -8850, -13788}, { -8935, -13733}, { -9019, -13678},
    { -9102, -13623}, { -9186, -13567}, { -9269, -13510}, { -9352, -13453}, { -9434, -13395}, { -9516, -13337}, { -9598, -13279}, { -9679, -13219},
    { -9760, -13160}, { -9841, -13100}, { -9921, -13039}, { -10001, -12978}, { -10080, -12916}, { -10159, -12854}, { -10238, -12792}, { -10316, -12729},
    { -10394, -12665}, { -10471, -12601}, { -10549, -12537}, { -10625, -12472}, { -10702, -12406}, { -10778, -12340}, { -10853, -12274}, { -10928, -12207},
    { -11003, -12140}, { -11077, -12072}, { -11151, -12004}, { -11224, -11935}, { -11297, -11866}, { -11370, -11797}, { -11442, -11727}, { -11514, -11656},
    { -11585, -11585}, { -11656, -11514}, { -11727, -11442}, { -11797, -11370}, { -11866, -11297}, { -11935, -11224}, { -12004, -11151}, { -12072, -11077},
    { -12140, -11003}, { -12207, -10928}, { -12274, -10853}, { -12340, -10778}, { -12406, -10702}, { -12472, -10625}, { -12537, -10549}, { -12601, -10471},
    { -12665, -10394}, { -12729, -10316}, { -12792, -10238}, { -12854, -10159}, { -12916, -10080}, { -12978, -10001}, { -13039,  -9921}, { -13100,  -9841},
    { -13160,  -9760}, { -13219,  -9679}, { -13279,  -9598}, { -13337,  -9516}, { -13395,  -9434}, { -13453,  -9352}, { -13510,  -9269}, { -13567,  -9186},
    { -13623,  -9102}, { -13678,  -9019}, { -13733,  -8935}, { -13788,  -8850}, { -13842,  -8765}, { -13896,  -8680}, { -13949,  -8595}, { -14001,  -8509},
    { -14053,  -8423}, { -14104,  -8337}, { -14155,  -8250}, { -14206,  -8163}, { -14256,  -8076}, { -14305,  -7988}, { -14354,  -7900}, { -14402,  -7812},
    { -14449,  -7723}, { -14497,  -7635}, { -14543,  -7545}, { -14589,  -7456}, { -14635,  -7366}, { -14680,  -7276}, { -14724,  -7186}, { -14768,  -7096},
    { -14811,  -7005}, { -14854,  -6914}, { -14896,  -6823}, { -14937,  -6731}, { -14978,  -6639}, { -15019,  -6547}, { -15059,  -6455}, { -15098,  -6363},
    { -15137,  -6270}, { -15175,  -6177}, { -15213,  -6084}, { -15250,  -5990}, { -15286,  -5897}, { -15322,  -5803}, { -15357,  -5708}, { -15392,  -5614},
    { -15426,  -5520}, { -15460,  -5425}, { -15493,  -5330}, { -15525,  -5235}, { -15557,  -5139}, { -15588,  -5044}, { -15619,  -4948}, { -15649,  -4852},
    { -15679,  -4756}, { -15707,  -4660}, { -15736,  -4563}, { -15763,  -4467}, { -15791,  -4370}, { -15817,  -4273}, { -15843,  -4176}, { -15868,  -4078},
    { -15893,  -3981}, { -15917,  -3883}, { -15941,  -3786}, { -15964,  -3688}, { -15986,  -3590}, { -16008,  -3492}, { -16029,  -3393}, { -16049,  -3295},
    { -16069,  -3196}, { -16088,  -3098}, { -16107,  -2999}, { -16125,  -2900}, { -16143,  -2801}, { -16160,  -2702}, { -16176,  -2603}, { -16192,  -2503},
    { -16207,  -2404}, { -16221,  -2305}, { -16235,  -2205}, { -16248,  -2105}, { -16261,  -2006}, { -16273,  -1906}, { -16284,  -1806}, { -16295,  -1706},
    { -16305,  -1606}, { -16315,  -1506}, { -16324,  -1406}, { -16332,  -1306}, { -16340,  -1205}, { -16347,  -1105}, { -16353,  -1005}, { -16359,   -904},
    { -16364,   -804}, { -16369,   -704}, { -16373,   -603}, { -16376,   -503}, { -16379,   -402}, { -16381,   -302}, { -16383,   -201}, { -16384,   -101},
    { -16384,      0}, { -16384,    101}, { -16383,    201}, { -16381,    302}, { -16379,    402}, { -16376,    503}, { -16373,    603}, { -16369,    704},
    { -16364,    804}, { -16359,    904}, { -16353,   1005}, { -16347,   1105}, { -16340,   1205}, { -16332,   1306}, { -16324,   1406}, { -16315,   1506},
    { -16305,   1606}, { -16295,   1706}, { -16284,   1806}, { -16273,   1906}, { -16261,   2006}, { -16248,   2105}, { -16235,   2205}, { -16221,   2305},
    { -16207,   2404}, { -16192,   2503}, { -16176,   2603}, { -16160,   2702}, { -16143,   2801}, { -16125,   2900}, { -16107,   2999}, { -16088,   3098},
    { -16069,   3196}, { -16049,   3295}, { -16029,   3393}, { -16008,   3492}, { -15986,   3590}, { -15964,   3688}, { -15941,   3786}, { -15917,   3883},
    { -15893,   3981}, { -15868,   4078}, { -15843,   4176}, { -15817,   4273}, { -15791,   4370}, { -15763,   4467}, { -15736,   4563}, { -15707,   4660},
    { -15679,   4756}, { -15649,   4852}, { -15619,   4948}, { -15588,   5044}, { -15557,   5139}, { -15525,   5235}, { -15493,   5330}, { -15460,   5425},
    { -15426,   5520}, { -15392,   5614}, { -15357,   5708}, { -15322,   5803}, { -15286,   5897}, { -15250,   5990}, { -15213,   6084}, { -15175,   6177},
    { -15137,   6270}, { -15098,   6363}, { -15059,   6455}, { -15019,   6547}, { -14978,   6639}, { -14937,   6731}, { -14896,   6823}, { -14854,   6914},
    { -14811,   7005}, { -14768,   7096}, { -14724,   7186}, { -14680,   7276}, { -14635,   7366}, { -14589,   7456}, { -14543,   7545}, { -14497,   7635},
    { -14449,   7723}, { -14402,   7812}, { -14354,   7900}, { -14305,   7988}, { -14256,   8076}, { -14206,   8163}, { -14155,   8250}, { -14104,   8337},
    { -14053,   8423}, { -14001,   8509}, { -13949,   8595}, { -13896,   8680}, { -13842,   8765}, { -13788,   8850}, { -13733,   8935}, { -13678,   9019},
    { -13623,   9102}, { -13567,   9186}, { -13510,   9269}, { -13453,   9352}, { -13395,   9434}, { -13337,   9516}, { -13279,   9598}, { -13219,   9679},
    { -13160,   9760}, { -13100,   9841}, { -13039,   9921}, { -12978,  10001}, { -12916,  10080}, { -12854,  10159}, { -12792,  10238}, { -12729,  10316},
    { -12665,  10394}, { -12601,  10471}, { -12537,  10549}, { -12472,  10625}, { -12406,  10702}, { -12340,  10778}, { -12274,  10853}, { -12207,  10928},
    { -12140,  11003}, { -12072,  11077}, { -12004,  11151}, { -11935,  11224}, { -11866,  11297}, { -11797,  11370}, { -11727,  11442}, { -11656,  11514},
    { -11585,  11585}, { -11514,  11656}, { -11442,  11727}, { -11370,  11797}, { -11297,  11866}, { -11224,  11935}, { -11151,  12004}, { -11077,  12072},
    { -11003,  12140}, { -10928,  12207}, { -10853,  12274}, { -10778,  12340}, { -10702,  12406}, { -10625,  12472}, { -10549,  12537}, { -10471,  12601},
    { -10394,  12665}, { -10316,  12729}, { -10238,  12792}, { -10159,  12854}, { -10080,  12916}, { -10001,  12978}, { -9921,  13039}, { -9841,  13100},
    { -9760,  13160}, { -9679,  13219}, { -9598,  13279}, { -9516,  13337}, { -9434,  13395}, { -9352,  13453}, { -9269,  13510}, { -9186,  13567},
    { -9102,  13623}, { -9019,  13678}, { -8935,  13733}, { -8850,  13788}, { -8765,  13842}, { -8680,  13896}, { -8595,  13949}, { -8509,  14001},
    { -8423,  14053}, { -8337,  14104}, { -8250,  14155}, { -8163,  14206}, { -8076,  14256}, { -7988,  14305}, { -7900,  14354}, { -7812,  14402},
    { -7723,  14449}, { -7635,  14497}, { -7545,  14543}, { -7456,  14589}, { -7366,  14635}, { -7276,  14680}, { -7186,  14724}, { -7096,  14768},
    { -7005,  14811}, { -6914,  14854}, { -6823,  14896}, { -6731,  14937}, { -6639,  14978}, { -6547,  15019}, { -6455,  15059}, { -6363,  15098},
    { -6270,  15137}, { -6177,  15175}, { -6084,  15213}, { -5990,  15250}, { -5897,  15286}, { -5803,  15322}, { -5708,  15357}, { -5614,  15392},
    { -5520,  15426}, { -5425,  15460}, { -5330,  15493}, { -5235,  15525}, { -5139,  15557}, { -5044,  15588}, { -4948,  15619}, { -4852,  15649},
    { -4756,  15679}, { -4660,  15707}, { -4563,  15736}, { -4467,  15763}, { -4370,  15791}, { -4273,  15817}, { -4176,  15843}, { -4078,  15868},
    { -3981,  15893}, { -3883,  15917}, { -3786,  15941}, { -3688,  15964}, { -3590,  15986}, { -3492,  16008}, { -3393,  16029}, { -3295,  16049},
    { -3196,  16069}, { -3098,  16088}, { -2999,  16107}, { -2900,  16125}, { -2801,  16143}, { -2702,  16160}, { -2603,  16176}, { -2503,  16192},
    { -2404,  16207}, { -2305,  16221}, { -2205,  16235}, { -2105,  16248}, { -2006,  16261}, { -1906,  16273}, { -1806,  16284}, { -1706,  16295},
    { -1606,  16305}, { -1506,  16315}, { -1406,  16324}, { -1306,  16332}, { -1205,  16340}, { -1105,  16347}, { -1005,  16353}, {  -904,  16359},
    {  -804,  16364}, {  -704,  16369}, {  -603,  16373}, {  -503,  16376}, {  -402,  16379}, {  -302,  16381}, {  -201,  16383}, {  -101,  16384}
#else
    { 0.00000000, -1.00000000}, { -0.00613588, -0.99998118}, { -0.01227154, -0.99992470}, { -0.01840673, -0.99983058},
    { -0.02454123, -0.99969882}, { -0.03067480, -0.99952942}, { -0.03680722, -0.99932238}, { -0.04293826, -0.99907773},
    { -0.04906767, -0.99879546}, { -0.05519524, -0.99847558}, { -0.06132074, -0.99811811}, { -0.06744392, -0.99772307},
    { -0.07356456, -0.99729046}, { -0.07968244, -0.99682030}, { -0.08579731, -0.99631261}, { -0.09190896, -0.99576741},
    { -0.09801714, -0.99518473}, { -0.10412163, -0.99456457}, { -0.11022221, -0.99390697}, { -0.11631863, -0.99321195},
    { -0.12241068, -0.99247953}, { -0.12849811, -0.99170975}, { -0.13458071, -0.99090264}, { -0.14065824, -0.99005821},
    { -0.14673047, -0.98917651}, { -0.15279719, -0.98825757}, { -0.15885814, -0.98730142}, { -0.16491312, -0.98630810},
    { -0.17096189, -0.98527764}, { -0.17700422, -0.98421009}, { -0.18303989, -0.98310549}, { -0.18906866, -0.98196387},
    { -0.19509032, -0.98078528}, { -0.20110463, -0.97956977}, { -0.20711138, -0.97831737}, { -0.21311032, -0.97702814},
    { -0.21910124, -0.97570213}, { -0.22508391, -0.97433938}, { -0.23105811, -0.97293995}, { -0.23702361, -0.97150389},
    { -0.24298018, -0.97003125}, { -0.24892761, -0.96852209}, { -0.25486566, -0.96697647}, { -0.26079412, -0.96539444},
    { -0.26671276, -0.96377607}, { -0.27262136, -0.96212140}, { -0.27851969, -0.96043052}, { -0.28440754, -0.95870347},
    { -0.29028468, -0.95694034}, { -0.29615089, -0.95514117}, { -0.30200595, -0.95330604}, { -0.30784964, -0.95143502},
    { -0.31368174, -0.94952818}, { -0.31950203, -0.94758559}, { -0.32531029, -0.94560733}, { -0.33110631, -0.94359346},
    { -0.33688985, -0.94154407}, { -0.34266072, -0.93945922}, { -0.34841868, -0.93733901}, { -0.35416353, -0.93518351},
    { -0.35989504, -0.93299280}, { -0.36561300, -0.93076696}, { -0.37131719, -0.92850608}, { -0.37700741, -0.92621024},
    { -0.38268343, -0.92387953}, { -0.38834505, -0.92151404}, { -0.39399204, -0.91911385}, { -0.39962420, -0.91667906},
    { -0.40524131, -0.91420976}, { -0.41084317, -0.91170603}, { -0.41642956, -0.90916798}, { -0.42200027, -0.90659570},
    { -0.42755509, -0.90398929}, { -0.43309382, -0.90134885}, { -0.43861624, -0.89867447}, { -0.44412214, -0.89596625},
    { -0.44961133, -0.89322430}, { -0.45508359, -0.89044872}, { -0.46053871, -0.88763962}, { -0.46597650, -0.88479710},
    { -0.47139674, -0.88192126}, { -0.47679923, -0.87901223}, { -0.48218377, -0.87607009}, { -0.48755016, -0.87309498},
    { -0.49289819, -0.87008699}, { -0.49822767, -0.86704625}, { -0.50353838, -0.86397286}, { -0.50883014, -0.86086694},
    { -0.51410274, -0.85772861}, { -0.51935599, -0.85455799}, { -0.52458968, -0.85135519}, { -0.52980362, -0.84812034},
    { -0.53499762, -0.84485357}, { -0.54017147, -0.84155498}, { -0.54532499, -0.83822471}, { -0.55045797, -0.83486287},
    { -0.55557023, -0.83146961}, { -0.56066158, -0.82804505}, { -0.56573181, -0.82458930}, { -0.57078075, -0.82110251},
    { -0.57580819, -0.81758481}, { -0.58081396, -0.81403633}, { -0.58579786, -0.81045720}, { -0.59075970, -0.80684755},
    { -0.59569930, -0.80320753}, { -0.60061648, -0.79953727}, { -0.60551104, -0.79583690}, { -0.61038281, -0.79210658},
    { -0.61523159, -0.78834643}, { -0.62005721, -0.78455660}, { -0.62485949, -0.78073723}, { -0.62963824, -0.77688847},
    { -0.63439328, -0.77301045}, { -0.63912444, -0.76910334}, { -0.64383154, -0.76516727}, { -0.64851440, -0.76120239},
    { -0.65317284, -0.75720885}, { -0.65780669, -0.75318680}, { -0.66241578, -0.74913639}, { -0.66699992, -0.74505779},
    { -0.67155895, -0.74095113}, { -0.67609270, -0.73681657}, { -0.68060100, -0.73265427}, { -0.68508367, -0.72846439},
    { -0.68954054, -0.72424708}, { -0.69397146, -0.72000251}, { -0.69837625, -0.71573083}, { -0.70275474, -0.71143220},
    { -0.70710678, -0.70710678}, { -0.71143220, -0.70275474}, { -0.71573083, -0.69837625}, { -0.72000251, -0.69397146},
    { -0.72424708, -0.68954054}, { -0.72846439, -0.68508367}, { -0.73265427, -0.68060100}, { -0.73681657, -0.67609270},
    { -0.74095113, -0.67155895}, { -0.74505779, -0.66699992}, { -0.74913639, -0.66241578}, { -0.75318680, -0.65780669},
    { -0.75720885, -0.65317284}, { -0.76120239, -0.64851440}, { -0.76516727, -0.64383154}, { -0.76910334, -0.63912444},
    { -0.77301045, -0.63439328}, { -0.77688847, -0.62963824}, { -0.78073723, -0.62485949}, { -0.78455660, -0.62005721},
    { -0.78834643, -0.61523159}, { -0.79210658, -0.61038281}, { -0.79583690, -0.60551104}, { -0.79953727, -0.60061648},
    { -0.80320753, -0.59569930}, { -0.80684755, -0.59075970}, { -0.81045720, -0.58579786}, { -0.81403633, -0.58081396},
    { -0.81758481, -0.57580819}, { -0.82110251, -0.57078075}, { -0.82458930, -0.56573181}, { -0.82804505, -0.56066158},
    { -0.83146961, -0.55557023}, { -0.83486287, -0.55045797}, { -0.83822471, -0.54532499}, { -0.84155498, -0.54017147},
    { -0.84485357, -0.53499762}, { -0.84812034, -0.52980362}, { -0.85135519, -0.52458968}, { -0.85455799, -0.51935599},
    { -0.85772861, -0.51410274}, { -0.86086694, -0.50883014}, { -0.86397286, -0.50353838}, { -0.86704625, -0.49822767},
    { -0.87008699, -0.49289819}, { -0.87309498, -0.48755016}, { -0.87607009, -0.48218377}, { -0.87901223, -0.47679923},
    { -0.88192126, -0.47139674}, { -0.88479710, -0.46597650}, { -0.88763962, -0.46053871}, { -0.89044872, -0.45508359},
    { -0.89322430, -0.44961133}, { -0.89596625, -0.44412214}, { -0.89867447, -0.43861624}, { -0.90134885, -0.43309382},
    { -0.90398929, -0.42755509}, { -0.90659570, -0.42200027}, { -0.90916798, -0.41642956}, { -0.91170603, -0.41084317},
    { -0.91420976, -0.40524131}, { -0.91667906, -0.39962420}, { -0.91911385, -0.39399204}, { -0.92151404, -0.38834505},
    { -0.92387953, -0.38268343}, { -0.92621024, -0.37700741}, { -0.92850608, -0.37131719}, { -0.93076696, -0.36561300},
    { -0.93299280, -0.35989504}, { -0.93518351, -0.35416353}, { -0.93733901, -0.34841868}, { -0.93945922, -0.34266072},
    { -0.94154407, -0.33688985}, { -0.94359346, -0.33110631}, { -0.94560733, -0.32531029}, { -0.94758559, -0.31950203},
    { -0.94952818, -0.31368174}, { -0.95143502, -0.30784964}, { -0.95330604, -0.30200595}, { -0.95514117, -0.29615089},
    { -0.95694034, -0.29028468}, { -0.95870347, -0.28440754}, { -0.96043052, -0.27851969}, { -0.96212140, -0.27262136},
    { -0.96377607, -0.26671276}, { -0.96539444, -0.26079412}, { -0.96697647, -0.25486566}, { -0.96852209, -0.24892761},
    { -0.97003125, -0.24298018}, { -0.97150389, -0.23702361}, { -0.97293995, -0.23105811}, { -0.97433938, -0.22508391},
    { -0.97570213, -0.21910124}, { -0.97702814, -0.21311032}, { -0.97831737, -0.20711138}, { -0.97956977, -0.20110463},
    { -0.98078528, -0.19509032}, { -0.98196387, -0.18906866}, { -0.98310549, -0.18303989}, { -0.98421009, -0.17700422},
    { -0.98527764, -0.17096189}, { -0.98630810, -0.16491312}, { -0.98730142, -0.15885814}, { -0.98825757, -0.15279719},
    { -0.98917651, -0.14673047}, { -0.99005821, -0.14065824}, { -0.99090264, -0.13458071}, { -0.99170975, -0.12849811},
    { -0.99247953, -0.12241068}, { -0.99321195, -0.11631863}, { -0.99390697, -0.11022221}, { -0.99456457, -0.10412163},
    { -0.99518473, -0.09801714}, { -0.99576741, -0.09190896}, { -0.99631261, -0.08579731}, { -0.99682030, -0.07968244},
    { -0.99729046, -0.07356456}, { -0.99772307, -0.06744392}, { -0.99811811, -0.06132074}, { -0.99847558, -0.05519524},
    { -0.99879546, -0.04906767}, { -0.99907773, -0.04293826}, { -0.99932238, -0.03680722}, { -0.99952942, -0.03067480},
    { -0.99969882, -0.02454123}, { -0.99983058, -0.01840673}, { -0.99992470, -0.01227154}, { -0.99998118, -0.00613588},
    { -1.00000000, -0.00000000}, { -0.99998118,  0.00613588}, { -0.99992470,  0.01227154}, { -0.99983058,  0.01840673},
    { -0.99969882,  0.02454123}, { -0.99952942,  0.03067480}, { -0.99932238,  0.03680722}, { -0.99907773,  0.04293826},
    { -0.99879546,  0.04906767}, { -0.99847558,  0.05519524}, { -0.99811811,  0.06132074}, { -0.99772307,  0.06744392},
    { -0.99729046,  0.07356456}, { -0.99682030,  0.07968244}, { -0.99631261,  0.08579731}, { -0.99576741,  0.09190896},
    { -0.99518473,  0.09801714}, { -0.99456457,  0.10412163}, { -0.99390697,  0.11022221}, { -0.99321195,  0.11631863},
    { -0.99247953,  0.12241068}, { -0.99170975,  0.12849811}, { -0.99090264,  0.13458071}, { -0.99005821,  0.14065824},
    { -0.98917651,  0.14673047}, { -0.98825757,  0.15279719}, { -0.98730142,  0.15885814}, { -0.98630810,  0.16491312},
    { -0.98527764,  0.17096189}, { -0.98421009,  0.17700422}, { -0.98310549,  0.18303989}, { -0.98196387,  0.18906866},
    { -0.98078528,  0.19509032}, { -0.97956977,  0.20110463}, { -0.97831737,  0.20711138}, { -0.97702814,  0.21311032},
    { -0.97570213,  0.21910124}, { -0.97433938,  0.22508391}, { -0.97293995,  0.23105811}, { -0.97150389,  0.23702361},
    { -0.97003125,  0.24298018}, { -0.96852209,  0.24892761}, { -0.96697647,  0.25486566}, { -0.96539444,  0.26079412},
    { -0.96377607,  0.26671276}, { -0.96212140,  0.27262136}, { -0.96043052,  0.27851969}, { -0.95870347,  0.28440754},
    { -0.95694034,  0.29028468}, { -0.95514117,  0.29615089}, { -0.95330604,  0.30200595}, { -0.95143502,  0.30784964},
    { -0.94952818,  0.31368174}, { -0.94758559,  0.31950203}, { -0.94560733,  0.32531029}, { -0.94359346,  0.33110631},
    { -0.94154407,  0.33688985}, { -0.93945922,  0.34266072}, { -0.93733901,  0.34841868}, { -0.93518351,  0.35416353},
    { -0.93299280,  0.35989504}, { -0.93076696,  0.36561300}, { -0.92850608,  0.37131719}, { -0.92621024,  0.37700741},
    { -0.92387953,  0.38268343}, { -0.92151404,  0.38834505}, { -0.91911385,  0.39399204}, { -0.91667906,  0.39962420},
    { -0.91420976,  0.40524131}, { -0.91170603,  0.41084317}, { -0.90916798,  0.41642956}, { -0.90659570,  0.42200027},
    { -0.90398929,  0.42755509}, { -0.90134885,  0.43309382}, { -0.89867447,  0.43861624}, { -0.89596625,  0.44412214},
    { -0.89322430,  0.44961133}, { -0.89044872,  0.45508359}, { -0.88763962,  0.46053871}, { -0.88479710,  0.46597650},
    { -0.88192126,  0.47139674}, { -0.87901223,  0.47679923}, { -0.87607009,  0.48218377}, { -0.87309498,  0.48755016},
    { -0.87008699,  0.49289819}, { -0.86704625,  0.49822767}, { -0.86397286,  0.50353838}, { -0.86086694,  0.50883014},
    { -0.85772861,  0.51410274}, { -0.85455799,  0.51935599}, { -0.85135519,  0.52458968}, { -0.84812034,  0.52980362},
    { -0.84485357,  0.53499762}, { -0.84155498,  0.54017147}, { -0.83822471,  0.54532499}, { -0.83486287,  0.55045797},
    { -0.83146961,  0.55557023}, { -0.82804505,  0.56066158}, { -0.82458930,  0.56573181}, { -0.82110251,  0.57078075},
    { -0.81758481,  0.57580819}, { -0.81403633,  0.58081396}, { -0.81045720,  0.58579786}, { -0.80684755,  0.59075970},
    { -0.80320753,  0.59569930}, { -0.79953727,  0.60061648}, { -0.79583690,  0.60551104}, { -0.79210658,  0.61038281},
    { -0.78834643,  0.61523159}, { -0.78455660,  0.62005721}, { -0.78073723,  0.62485949}, { -0.77688847,  0.62963824},
    { -0.77301045,  0.63439328}, { -0.76910334,  0.63912444}, { -0.76516727,  0.64383154}, { -0.76120239,  0.64851440},
    { -0.75720885,  0.65317284}, { -0.75318680,  0.65780669}, { -0.74913639,  0.66241578}, { -0.74505779,  0.66699992},
    { -0.74095113,  0.67155895}, { -0.73681657,  0.67609270}, { -0.73265427,  0.68060100}, { -0.72846439,  0.68508367},
    { -0.72424708,  0.68954054}, { -0.72000251,  0.69397146}, { -0.71573083,  0.69837625}, { -0.71143220,  0.70275474},
    { -0.70710678,  0.70710678}, { -0.70275474,  0.71143220}, { -0.69837625,  0.71573083}, { -0.69397146,  0.72000251},
    { -0.68954054,  0.72424708}, { -0.68508367,  0.72846439}, { -0.68060100,  0.73265427}, { -0.67609270,  0.73681657},
    { -0.67155895,  0.74095113}, { -0.66699992,  0.74505779}, { -0.66241578,  0.74913639}, { -0.65780669,  0.75318680},
    { -0.65317284,  0.75720885}, { -0.64851440,  0.76120239}, { -0.64383154,  0.76516727}, { -0.63912444,  0.76910334},
    { -0.63439328,  0.77301045}, { -0.62963824,  0.77688847}, { -0.62485949,  0.78073723}, { -0.62005721,  0.78455660},
    { -0.61523159,  0.78834643}, { -0.61038281,  0.79210658}, { -0.60551104,  0.79583690}, { -0.60061648,  0.79953727},
    { -0.59569930,  0.80320753}, { -0.59075970,  0.80684755}, { -0.58579786,  0.81045720}, { -0.58081396,  0.81403633},
    { -0.57580819,  0.81758481}, { -0.57078075,  0.82110251}, { -0.56573181,  0.82458930}, { -0.56066158,  0.82804505},
    { -0.55557023,  0.83146961}, { -0.55045797,  0.83486287}, { -0.54532499,  0.83822471}, { -0.54017147,  0.84155498},
    { -0.53499762,  0.84485357}, { -0.52980362,  0.84812034}, { -0.52458968,  0.85135519}, { -0.51935599,  0.85455799},
    { -0.51410274,  0.85772861}, { -0.50883014,  0.86086694}, { -0.50353838,  0.86397286}, { -0.49822767,  0.86704625},
    { -0.49289819,  0.87008699}, { -0.48755016,  0.87309498}, { -0.48218377,  0.87607009}, { -0.47679923,  0.87901223},
    { -0.47139674,  0.88192126}, { -0.46597650,  0.88479710}, { -0.46053871,  0.88763962}, { -0.45508359,  0.89044872},
    { -0.44961133,  0.89322430}, { -0.44412214,  0.89596625}, { -0.43861624,  0.89867447}, { -0.43309382,  0.90134885},
    { -0.42755509,  0.90398929}, { -0.42200027,  0.90659570}, { -0.41642956,  0.90916798}, { -0.41084317,  0.91170603},
    { -0.40524131,  0.91420976}, { -0.39962420,  0.91667906}, { -0.39399204,  0.91911385}, { -0.38834505,  0.92151404},
    { -0.38268343,  0.92387953}, { -0.37700741,  0.92621024}, { -0.37131719,  0.92850608}, { -0.36561300,  0.93076696},
    { -0.35989504,  0.93299280}, { -0.35416353,  0.93518351}, { -0.34841868,  0.93733901}, { -0.34266072,  0.93945922},
    { -0.33688985,  0.94154407}, { -0.33110631,  0.94359346}, { -0.32531029,  0.94560733}, { -0.31950203,  0.94758559},
    { -0.31368174,  0.94952818}, { -0.30784964,  0.95143502}, { -0.30200595,  0.95330604}, { -0.29615089,  0.95514117},
    { -0.29028468,  0.95694034}, { -0.28440754,  0.95870347}, { -0.27851969,  0.96043052}, { -0.27262136,  0.96212140},
    { -0.26671276,  0.96377607}, { -0.26079412,  0.96539444}, { -0.25486566,  0.96697647}, { -0.24892761,  0.96852209},
    { -0.24298018,  0.97003125}, { -0.23702361,  0.97150389}, { -0.23105811,  0.97293995}, { -0.22508391,  0.97433938},
    { -0.21910124,  0.97570213}, { -0.21311032,  0.97702814}, { -0.20711138,  0.97831737}, { -0.20110463,  0.97956977},
    { -0.19509032,  0.98078528}, { -0.18906866,  0.98196387}, { -0.18303989,  0.98310549}, { -0.17700422,  0.98421009},
    { -0.17096189,  0.98527764}, { -0.16491312,  0.98630810}, { -0.15885814,  0.98730142}, { -0.15279719,  0.98825757},
    { -0.14673047,  0.98917651}, { -0.14065824,  0.99005821}, { -0.13458071,  0.99090264}, { -0.12849811,  0.99170975},
    { -0.12241068,  0.99247953}, { -0.11631863,  0.99321195}, { -0.11022221,  0.99390697}, { -0.10412163,  0.99456457},
    { -0.09801714,  0.99518473}, { -0.09190896,  0.99576741}, { -0.08579731,  0.99631261}, { -0.07968244,  0.99682030},
    { -0.07356456,  0.99729046}, { -0.06744392,  0.99772307}, { -0.06132074,  0.99811811}, { -0.05519524,  0.99847558},
    { -0.04906767,  0.99879546}, { -0.04293826,  0.99907773}, { -0.03680722,  0.99932238}, { -0.03067480,  0.99952942},
    { -0.02454123,  0.99969882}, { -0.01840673,  0.99983058}, { -0.01227154,  0.99992470}, { -0.00613588,  0.99998118},
#endif
};

#endif

#if (AISP_TSL_NFFT == 512)
const aisp_cpx_s16_t twiddles_tab_512[256] =
{
    { 16384,      0}, { 16379,   -402}, { 16364,   -804}, { 16340,  -1205}, { 16305,  -1606}, { 16261,  -2006}, { 16207,  -2404}, { 16143,  -2801},
    { 16069,  -3196}, { 15986,  -3590}, { 15893,  -3981}, { 15791,  -4370}, { 15679,  -4756}, { 15557,  -5139}, { 15426,  -5520}, { 15286,  -5897},
    { 15137,  -6270}, { 14978,  -6639}, { 14811,  -7005}, { 14635,  -7366}, { 14449,  -7723}, { 14256,  -8076}, { 14053,  -8423}, { 13842,  -8765},
    { 13623,  -9102}, { 13395,  -9434}, { 13160,  -9760}, { 12916, -10080}, { 12665, -10394}, { 12406, -10702}, { 12140, -11003}, { 11866, -11297},
    { 11585, -11585}, { 11297, -11866}, { 11003, -12140}, { 10702, -12406}, { 10394, -12665}, { 10080, -12916}, {  9760, -13160}, {  9434, -13395},
    {  9102, -13623}, {  8765, -13842}, {  8423, -14053}, {  8076, -14256}, {  7723, -14449}, {  7366, -14635}, {  7005, -14811}, {  6639, -14978},
    {  6270, -15137}, {  5897, -15286}, {  5520, -15426}, {  5139, -15557}, {  4756, -15679}, {  4370, -15791}, {  3981, -15893}, {  3590, -15986},
    {  3196, -16069}, {  2801, -16143}, {  2404, -16207}, {  2006, -16261}, {  1606, -16305}, {  1205, -16340}, {   804, -16364}, {   402, -16379},
    {     0, -16384}, {  -402, -16379}, {  -804, -16364}, { -1205, -16340}, { -1606, -16305}, { -2006, -16261}, { -2404, -16207}, { -2801, -16143},
    { -3196, -16069}, { -3590, -15986}, { -3981, -15893}, { -4370, -15791}, { -4756, -15679}, { -5139, -15557}, { -5520, -15426}, { -5897, -15286},
    { -6270, -15137}, { -6639, -14978}, { -7005, -14811}, { -7366, -14635}, { -7723, -14449}, { -8076, -14256}, { -8423, -14053}, { -8765, -13842},
    { -9102, -13623}, { -9434, -13395}, { -9760, -13160}, { -10080, -12916}, { -10394, -12665}, { -10702, -12406}, { -11003, -12140}, { -11297, -11866},
    { -11585, -11585}, { -11866, -11297}, { -12140, -11003}, { -12406, -10702}, { -12665, -10394}, { -12916, -10080}, { -13160,  -9760}, { -13395,  -9434},
    { -13623,  -9102}, { -13842,  -8765}, { -14053,  -8423}, { -14256,  -8076}, { -14449,  -7723}, { -14635,  -7366}, { -14811,  -7005}, { -14978,  -6639},
    { -15137,  -6270}, { -15286,  -5897}, { -15426,  -5520}, { -15557,  -5139}, { -15679,  -4756}, { -15791,  -4370}, { -15893,  -3981}, { -15986,  -3590},
    { -16069,  -3196}, { -16143,  -2801}, { -16207,  -2404}, { -16261,  -2006}, { -16305,  -1606}, { -16340,  -1205}, { -16364,   -804}, { -16379,   -402},
    { -16384,      0}, { -16379,    402}, { -16364,    804}, { -16340,   1205}, { -16305,   1606}, { -16261,   2006}, { -16207,   2404}, { -16143,   2801},
    { -16069,   3196}, { -15986,   3590}, { -15893,   3981}, { -15791,   4370}, { -15679,   4756}, { -15557,   5139}, { -15426,   5520}, { -15286,   5897},
    { -15137,   6270}, { -14978,   6639}, { -14811,   7005}, { -14635,   7366}, { -14449,   7723}, { -14256,   8076}, { -14053,   8423}, { -13842,   8765},
    { -13623,   9102}, { -13395,   9434}, { -13160,   9760}, { -12916,  10080}, { -12665,  10394}, { -12406,  10702}, { -12140,  11003}, { -11866,  11297},
    { -11585,  11585}, { -11297,  11866}, { -11003,  12140}, { -10702,  12406}, { -10394,  12665}, { -10080,  12916}, { -9760,  13160}, { -9434,  13395},
    { -9102,  13623}, { -8765,  13842}, { -8423,  14053}, { -8076,  14256}, { -7723,  14449}, { -7366,  14635}, { -7005,  14811}, { -6639,  14978},
    { -6270,  15137}, { -5897,  15286}, { -5520,  15426}, { -5139,  15557}, { -4756,  15679}, { -4370,  15791}, { -3981,  15893}, { -3590,  15986},
    { -3196,  16069}, { -2801,  16143}, { -2404,  16207}, { -2006,  16261}, { -1606,  16305}, { -1205,  16340}, {  -804,  16364}, {  -402,  16379},
    {     0,  16384}, {   402,  16379}, {   804,  16364}, {  1205,  16340}, {  1606,  16305}, {  2006,  16261}, {  2404,  16207}, {  2801,  16143},
    {  3196,  16069}, {  3590,  15986}, {  3981,  15893}, {  4370,  15791}, {  4756,  15679}, {  5139,  15557}, {  5520,  15426}, {  5897,  15286},
    {  6270,  15137}, {  6639,  14978}, {  7005,  14811}, {  7366,  14635}, {  7723,  14449}, {  8076,  14256}, {  8423,  14053}, {  8765,  13842},
    {  9102,  13623}, {  9434,  13395}, {  9760,  13160}, { 10080,  12916}, { 10394,  12665}, { 10702,  12406}, { 11003,  12140}, { 11297,  11866},
    { 11585,  11585}, { 11866,  11297}, { 12140,  11003}, { 12406,  10702}, { 12665,  10394}, { 12916,  10080}, { 13160,   9760}, { 13395,   9434},
    { 13623,   9102}, { 13842,   8765}, { 14053,   8423}, { 14256,   8076}, { 14449,   7723}, { 14635,   7366}, { 14811,   7005}, { 14978,   6639},
    { 15137,   6270}, { 15286,   5897}, { 15426,   5520}, { 15557,   5139}, { 15679,   4756}, { 15791,   4370}, { 15893,   3981}, { 15986,   3590},
    { 16069,   3196}, { 16143,   2801}, { 16207,   2404}, { 16261,   2006}, { 16305,   1606}, { 16340,   1205}, { 16364,    804}, { 16379,    402}
};

const aisp_cpx_s16_t super_twiddles_512[256] =
{
    {     0, -16384}, {  -201, -16383}, {  -402, -16379}, {  -603, -16373}, {  -804, -16364}, { -1005, -16353}, { -1205, -16340}, { -1406, -16324},
    { -1606, -16305}, { -1806, -16284}, { -2006, -16261}, { -2205, -16235}, { -2404, -16207}, { -2603, -16176}, { -2801, -16143}, { -2999, -16107},
    { -3196, -16069}, { -3393, -16029}, { -3590, -15986}, { -3786, -15941}, { -3981, -15893}, { -4176, -15843}, { -4370, -15791}, { -4563, -15736},
    { -4756, -15679}, { -4948, -15619}, { -5139, -15557}, { -5330, -15493}, { -5520, -15426}, { -5708, -15357}, { -5897, -15286}, { -6084, -15213},
    { -6270, -15137}, { -6455, -15059}, { -6639, -14978}, { -6823, -14896}, { -7005, -14811}, { -7186, -14724}, { -7366, -14635}, { -7545, -14543},
    { -7723, -14449}, { -7900, -14354}, { -8076, -14256}, { -8250, -14155}, { -8423, -14053}, { -8595, -13949}, { -8765, -13842}, { -8935, -13733},
    { -9102, -13623}, { -9269, -13510}, { -9434, -13395}, { -9598, -13279}, { -9760, -13160}, { -9921, -13039}, { -10080, -12916}, { -10238, -12792},
    { -10394, -12665}, { -10549, -12537}, { -10702, -12406}, { -10853, -12274}, { -11003, -12140}, { -11151, -12004}, { -11297, -11866}, { -11442, -11727},
    { -11585, -11585}, { -11727, -11442}, { -11866, -11297}, { -12004, -11151}, { -12140, -11003}, { -12274, -10853}, { -12406, -10702}, { -12537, -10549},
    { -12665, -10394}, { -12792, -10238}, { -12916, -10080}, { -13039,  -9921}, { -13160,  -9760}, { -13279,  -9598}, { -13395,  -9434}, { -13510,  -9269},
    { -13623,  -9102}, { -13733,  -8935}, { -13842,  -8765}, { -13949,  -8595}, { -14053,  -8423}, { -14155,  -8250}, { -14256,  -8076}, { -14354,  -7900},
    { -14449,  -7723}, { -14543,  -7545}, { -14635,  -7366}, { -14724,  -7186}, { -14811,  -7005}, { -14896,  -6823}, { -14978,  -6639}, { -15059,  -6455},
    { -15137,  -6270}, { -15213,  -6084}, { -15286,  -5897}, { -15357,  -5708}, { -15426,  -5520}, { -15493,  -5330}, { -15557,  -5139}, { -15619,  -4948},
    { -15679,  -4756}, { -15736,  -4563}, { -15791,  -4370}, { -15843,  -4176}, { -15893,  -3981}, { -15941,  -3786}, { -15986,  -3590}, { -16029,  -3393},
    { -16069,  -3196}, { -16107,  -2999}, { -16143,  -2801}, { -16176,  -2603}, { -16207,  -2404}, { -16235,  -2205}, { -16261,  -2006}, { -16284,  -1806},
    { -16305,  -1606}, { -16324,  -1406}, { -16340,  -1205}, { -16353,  -1005}, { -16364,   -804}, { -16373,   -603}, { -16379,   -402}, { -16383,   -201},
    { -16384,      0}, { -16383,    201}, { -16379,    402}, { -16373,    603}, { -16364,    804}, { -16353,   1005}, { -16340,   1205}, { -16324,   1406},
    { -16305,   1606}, { -16284,   1806}, { -16261,   2006}, { -16235,   2205}, { -16207,   2404}, { -16176,   2603}, { -16143,   2801}, { -16107,   2999},
    { -16069,   3196}, { -16029,   3393}, { -15986,   3590}, { -15941,   3786}, { -15893,   3981}, { -15843,   4176}, { -15791,   4370}, { -15736,   4563},
    { -15679,   4756}, { -15619,   4948}, { -15557,   5139}, { -15493,   5330}, { -15426,   5520}, { -15357,   5708}, { -15286,   5897}, { -15213,   6084},
    { -15137,   6270}, { -15059,   6455}, { -14978,   6639}, { -14896,   6823}, { -14811,   7005}, { -14724,   7186}, { -14635,   7366}, { -14543,   7545},
    { -14449,   7723}, { -14354,   7900}, { -14256,   8076}, { -14155,   8250}, { -14053,   8423}, { -13949,   8595}, { -13842,   8765}, { -13733,   8935},
    { -13623,   9102}, { -13510,   9269}, { -13395,   9434}, { -13279,   9598}, { -13160,   9760}, { -13039,   9921}, { -12916,  10080}, { -12792,  10238},
    { -12665,  10394}, { -12537,  10549}, { -12406,  10702}, { -12274,  10853}, { -12140,  11003}, { -12004,  11151}, { -11866,  11297}, { -11727,  11442},
    { -11585,  11585}, { -11442,  11727}, { -11297,  11866}, { -11151,  12004}, { -11003,  12140}, { -10853,  12274}, { -10702,  12406}, { -10549,  12537},
    { -10394,  12665}, { -10238,  12792}, { -10080,  12916}, { -9921,  13039}, { -9760,  13160}, { -9598,  13279}, { -9434,  13395}, { -9269,  13510},
    { -9102,  13623}, { -8935,  13733}, { -8765,  13842}, { -8595,  13949}, { -8423,  14053}, { -8250,  14155}, { -8076,  14256}, { -7900,  14354},
    { -7723,  14449}, { -7545,  14543}, { -7366,  14635}, { -7186,  14724}, { -7005,  14811}, { -6823,  14896}, { -6639,  14978}, { -6455,  15059},
    { -6270,  15137}, { -6084,  15213}, { -5897,  15286}, { -5708,  15357}, { -5520,  15426}, { -5330,  15493}, { -5139,  15557}, { -4948,  15619},
    { -4756,  15679}, { -4563,  15736}, { -4370,  15791}, { -4176,  15843}, { -3981,  15893}, { -3786,  15941}, { -3590,  15986}, { -3393,  16029},
    { -3196,  16069}, { -2999,  16107}, { -2801,  16143}, { -2603,  16176}, { -2404,  16207}, { -2205,  16235}, { -2006,  16261}, { -1806,  16284},
    { -1606,  16305}, { -1406,  16324}, { -1205,  16340}, { -1005,  16353}, {  -804,  16364}, {  -603,  16373}, {  -402,  16379}, {  -201,  16383}
};
#endif

#if (AISP_TSL_NFFT == 256)
const aisp_cpx_s16_t twiddles_tab_256[128] =
{
    { 16384,      0}, { 16364,   -804}, { 16305,  -1606}, { 16207,  -2404}, { 16069,  -3196}, { 15893,  -3981}, { 15679,  -4756}, { 15426,  -5520},
    { 15137,  -6270}, { 14811,  -7005}, { 14449,  -7723}, { 14053,  -8423}, { 13623,  -9102}, { 13160,  -9760}, { 12665, -10394}, { 12140, -11003},
    { 11585, -11585}, { 11003, -12140}, { 10394, -12665}, {  9760, -13160}, {  9102, -13623}, {  8423, -14053}, {  7723, -14449}, {  7005, -14811},
    {  6270, -15137}, {  5520, -15426}, {  4756, -15679}, {  3981, -15893}, {  3196, -16069}, {  2404, -16207}, {  1606, -16305}, {   804, -16364},
    {     0, -16384}, {  -804, -16364}, { -1606, -16305}, { -2404, -16207}, { -3196, -16069}, { -3981, -15893}, { -4756, -15679}, { -5520, -15426},
    { -6270, -15137}, { -7005, -14811}, { -7723, -14449}, { -8423, -14053}, { -9102, -13623}, { -9760, -13160}, { -10394, -12665}, { -11003, -12140},
    { -11585, -11585}, { -12140, -11003}, { -12665, -10394}, { -13160,  -9760}, { -13623,  -9102}, { -14053,  -8423}, { -14449,  -7723}, { -14811,  -7005},
    { -15137,  -6270}, { -15426,  -5520}, { -15679,  -4756}, { -15893,  -3981}, { -16069,  -3196}, { -16207,  -2404}, { -16305,  -1606}, { -16364,   -804},
    { -16384,      0}, { -16364,    804}, { -16305,   1606}, { -16207,   2404}, { -16069,   3196}, { -15893,   3981}, { -15679,   4756}, { -15426,   5520},
    { -15137,   6270}, { -14811,   7005}, { -14449,   7723}, { -14053,   8423}, { -13623,   9102}, { -13160,   9760}, { -12665,  10394}, { -12140,  11003},
    { -11585,  11585}, { -11003,  12140}, { -10394,  12665}, { -9760,  13160}, { -9102,  13623}, { -8423,  14053}, { -7723,  14449}, { -7005,  14811},
    { -6270,  15137}, { -5520,  15426}, { -4756,  15679}, { -3981,  15893}, { -3196,  16069}, { -2404,  16207}, { -1606,  16305}, {  -804,  16364},
    {     0,  16384}, {   804,  16364}, {  1606,  16305}, {  2404,  16207}, {  3196,  16069}, {  3981,  15893}, {  4756,  15679}, {  5520,  15426},
    {  6270,  15137}, {  7005,  14811}, {  7723,  14449}, {  8423,  14053}, {  9102,  13623}, {  9760,  13160}, { 10394,  12665}, { 11003,  12140},
    { 11585,  11585}, { 12140,  11003}, { 12665,  10394}, { 13160,   9760}, { 13623,   9102}, { 14053,   8423}, { 14449,   7723}, { 14811,   7005},
    { 15137,   6270}, { 15426,   5520}, { 15679,   4756}, { 15893,   3981}, { 16069,   3196}, { 16207,   2404}, { 16305,   1606}, { 16364,    804}
};

const aisp_cpx_s16_t super_twiddles_256[128] =
{
    {     0, -16384}, {  -402, -16379}, {  -804, -16364}, { -1205, -16340}, { -1606, -16305}, { -2006, -16261}, { -2404, -16207}, { -2801, -16143},
    { -3196, -16069}, { -3590, -15986}, { -3981, -15893}, { -4370, -15791}, { -4756, -15679}, { -5139, -15557}, { -5520, -15426}, { -5897, -15286},
    { -6270, -15137}, { -6639, -14978}, { -7005, -14811}, { -7366, -14635}, { -7723, -14449}, { -8076, -14256}, { -8423, -14053}, { -8765, -13842},
    { -9102, -13623}, { -9434, -13395}, { -9760, -13160}, { -10080, -12916}, { -10394, -12665}, { -10702, -12406}, { -11003, -12140}, { -11297, -11866},
    { -11585, -11585}, { -11866, -11297}, { -12140, -11003}, { -12406, -10702}, { -12665, -10394}, { -12916, -10080}, { -13160,  -9760}, { -13395,  -9434},
    { -13623,  -9102}, { -13842,  -8765}, { -14053,  -8423}, { -14256,  -8076}, { -14449,  -7723}, { -14635,  -7366}, { -14811,  -7005}, { -14978,  -6639},
    { -15137,  -6270}, { -15286,  -5897}, { -15426,  -5520}, { -15557,  -5139}, { -15679,  -4756}, { -15791,  -4370}, { -15893,  -3981}, { -15986,  -3590},
    { -16069,  -3196}, { -16143,  -2801}, { -16207,  -2404}, { -16261,  -2006}, { -16305,  -1606}, { -16340,  -1205}, { -16364,   -804}, { -16379,   -402},
    { -16384,      0}, { -16379,    402}, { -16364,    804}, { -16340,   1205}, { -16305,   1606}, { -16261,   2006}, { -16207,   2404}, { -16143,   2801},
    { -16069,   3196}, { -15986,   3590}, { -15893,   3981}, { -15791,   4370}, { -15679,   4756}, { -15557,   5139}, { -15426,   5520}, { -15286,   5897},
    { -15137,   6270}, { -14978,   6639}, { -14811,   7005}, { -14635,   7366}, { -14449,   7723}, { -14256,   8076}, { -14053,   8423}, { -13842,   8765},
    { -13623,   9102}, { -13395,   9434}, { -13160,   9760}, { -12916,  10080}, { -12665,  10394}, { -12406,  10702}, { -12140,  11003}, { -11866,  11297},
    { -11585,  11585}, { -11297,  11866}, { -11003,  12140}, { -10702,  12406}, { -10394,  12665}, { -10080,  12916}, { -9760,  13160}, { -9434,  13395},
    { -9102,  13623}, { -8765,  13842}, { -8423,  14053}, { -8076,  14256}, { -7723,  14449}, { -7366,  14635}, { -7005,  14811}, { -6639,  14978},
    { -6270,  15137}, { -5897,  15286}, { -5520,  15426}, { -5139,  15557}, { -4756,  15679}, { -4370,  15791}, { -3981,  15893}, { -3590,  15986},
    { -3196,  16069}, { -2801,  16143}, { -2404,  16207}, { -2006,  16261}, { -1606,  16305}, { -1205,  16340}, {  -804,  16364}, {  -402,  16379}
};

#endif
#endif
static short *bit_reverse_gen(short len, int radix)
{
    short  i       = 0;
    short  j       = 0;
    short  width   = 0;
    short  tmp_len = 1;
    short  tmp1    = 0;
    short  tmp2    = 0;
    short *rvs_idx = NULL;
#ifdef TH1520_CORE
    rvs_idx = (short *)AISP_MEM_CALLOC(1, len * sizeof(short));
#else
    rvs_idx = (short *)AISP_MEM_CALLOC(len * sizeof(short), 1);
#endif

    while (tmp_len < len)
    {
        tmp_len <<= 1;
        width    += 1;
    }

    if (radix == 4)
    {
        for (i = 0; i < len; i++)
        {
            tmp2 = 0;

            for (j = 0; j < width; j += 2)
            {
                tmp2 <<= 2;
                tmp1   = 0x03 << j;
                tmp1  &= i;
                tmp2  |= tmp1 >> j;
            }

            rvs_idx[i] = tmp2;
        }
    }
    else
        if (radix == 2)
        {
            for (i = 0; i < len; i++)
            {
                tmp2 = 0;

                for (j = 0; j < width; j++)
                {
                    tmp2 <<= 1;
                    tmp1   = 0x01 << j;
                    tmp1  &= i;
                    tmp2  |= tmp1 >> j;
                }

                rvs_idx[i] = tmp2;
            }
        }

    return rvs_idx;
}

aisp_fft_eng_t *AISP_TSL_fft32_init(short nfft)
{
    short  i       = 0;
    short  tmp     = 0;
    short  ncfft   = 0;
    short  tmp_len = 1;
    short *tmp_idx = NULL;
    aisp_fft_eng_t *pstFftEng = NULL;
    short *pIdx_tab = NULL;
#ifdef TH1520_CORE
    pstFftEng = (aisp_fft_eng_t *)AISP_MEM_CALLOC(1, sizeof(aisp_fft_eng_t));
#else
    pstFftEng = (aisp_fft_eng_t *)AISP_MEM_CALLOC(sizeof(aisp_fft_eng_t), 1);
#endif

    if (NULL == pstFftEng)
    {
#ifdef AISP_TSL_INFO
        printf("aisp_fft_eng malloc fail!\n");
#endif
        return NULL;
    }

    ncfft = nfft >> 1;

    while (tmp_len < ncfft)
    {
        tmp_len <<= 1;
        tmp      += 1;
    }

    pstFftEng->len     = nfft;
    pstFftEng->ncfft   = ncfft;
    pstFftEng->width   = tmp;
#ifndef USE_HIFI4_OPTIMIZE
    pstFftEng->cpx_tmp = (aisp_cpx_s32_t *)AISP_MEM_CALLOC(ncfft * sizeof(aisp_cpx_s32_t), 1);
    pstFftEng->tmp_buf = (aisp_cpx_s32_t *)AISP_MEM_CALLOC(ncfft * sizeof(aisp_cpx_s32_t), 1);
#endif

    switch (nfft)
    {
#if (AISP_TSL_NFFT == 1024)

        case 1024:
            pstFftEng->twiddles       = (aisp_cpx_s16_t *)twiddles_tab_1024;
            pstFftEng->super_twiddles = (aisp_cpx_s16_t *)super_twiddles_1024;
            break;
#endif
#if (AISP_TSL_NFFT == 512)

        case 512:
            pstFftEng->twiddles       = (aisp_cpx_s16_t *)twiddles_tab_512;
            pstFftEng->super_twiddles = (aisp_cpx_s16_t *)super_twiddles_512;
            break;
#endif
#if (AISP_TSL_NFFT == 256)

        case 256:
            pstFftEng->twiddles       = (aisp_cpx_s16_t *)twiddles_tab_256;
            pstFftEng->super_twiddles = (aisp_cpx_s16_t *)super_twiddles_256;
            break;
#endif

        default:
            pstFftEng->twiddles       = NULL;
            pstFftEng->super_twiddles = NULL;
            break;
    }

    if (tmp & 0x0001)
    {
        ncfft >>= 1;
        tmp_idx = bit_reverse_gen(ncfft, 4);
#ifdef TH1520_CORE
        short *pIdx_tab = (short *)AISP_MEM_CALLOC(1, pstFftEng->ncfft * sizeof(short));
#else
        pIdx_tab = (short *)AISP_MEM_CALLOC(pstFftEng->ncfft * sizeof(short), 1);
#endif

        for (i = 0; i < ncfft; i++)
        {
            pIdx_tab[i]       = tmp_idx[i] << 1;
            pIdx_tab[i + ncfft] = (tmp_idx[i] << 1) + 1;
        }

        AISP_MEM_FREE(tmp_idx);
        pstFftEng->stage_num = 2;
        pstFftEng->pIdx_tab  = pIdx_tab;
    }
    else
    {
        pstFftEng->pIdx_tab  = bit_reverse_gen(pstFftEng->ncfft, 4);
        pstFftEng->stage_num = 1;
    }

    return pstFftEng;
}

static void AISP_TSL_fft32_bfly2(aisp_cpx_s32_t *Fout, short M, short N, aisp_cpx_s16_t *twiddles)
{
    short i            = 0;
    short j            = 0;
    aisp_cpx_s32_t tmp = {0, 0};
    aisp_cpx_s32_t *Fout1 = NULL;
    aisp_cpx_s32_t *Fout2 = NULL;
    aisp_cpx_s16_t *tw1   = NULL;
    int iSize = M << 1;
    Fout1 = Fout;
    Fout2 = Fout + M;

    for (i = 1; i <= N; i++)
    {
        tw1 = twiddles;

        for (j = 0; j < M; j++)
        {
            tmp.real =  PSHR((aisp_s64_t)Fout2[j].real * tw1->real - (aisp_s64_t)Fout2[j].imag * tw1->imag, 14);
            tmp.imag =  PSHR((aisp_s64_t)Fout2[j].imag * tw1->real + (aisp_s64_t)Fout2[j].real * tw1->imag, 14);
            tw1 += N;
            Fout2[j].real = Fout1[j].real - tmp.real;
            Fout2[j].imag = Fout1[j].imag - tmp.imag;
            Fout1[j].real = Fout1[j].real + tmp.real;
            Fout1[j].imag = Fout1[j].imag + tmp.imag;
        }

        Fout1 += iSize;
        Fout2 += iSize;
    }
}

static void AISP_TSL_ifft32_bfly2(aisp_cpx_s32_t *Fout, short M, short N, aisp_cpx_s16_t *twiddles)
{
    short i               = 0;
    short j               = 0;
    aisp_cpx_s32_t tmp1   = {0, 0};
    aisp_cpx_s32_t tmp2   = {0, 0};
    aisp_cpx_s32_t *Fout1 = NULL;
    aisp_cpx_s32_t *Fout2 = NULL;
    aisp_cpx_s16_t *tw1   = NULL;
    int iSize = M << 1;
    Fout1 = Fout;
    Fout2 = Fout + M;

    for (i = 0; i < N; i++)
    {
        tw1 = twiddles;

        for (j = 0; j < M; j++)
        {
            tmp1.real = PSHR((aisp_s64_t)Fout1[j].real, 1);
            tmp1.imag = PSHR((aisp_s64_t)Fout1[j].imag, 1);
            tmp2.real = PSHR((aisp_s64_t)Fout2[j].real * tw1->real + (aisp_s64_t)Fout2[j].imag * tw1->imag, 15);
            tmp2.imag = PSHR((aisp_s64_t)Fout2[j].imag * tw1->real - (aisp_s64_t)Fout2[j].real * tw1->imag, 15);
            Fout2[j].real = tmp1.real - tmp2.real;
            Fout2[j].imag = tmp1.imag - tmp2.imag;
            Fout1[j].real = tmp1.real + tmp2.real;
            Fout1[j].imag = tmp1.imag + tmp2.imag;
            tw1 += N;
        }

        Fout1 += iSize;
        Fout2 += iSize;
    }
}

static void AISP_TSL_fft32_bfly4(aisp_cpx_s32_t *Fout, short M, short N, aisp_cpx_s16_t *twiddles)
{
    short i   = 0;
    short j   = 0;
    short d_N = 0;
    short t_N = 0;
    aisp_cpx_s32_t tmp1   = {0, 0};
    aisp_cpx_s32_t tmp2   = {0, 0};
    aisp_cpx_s32_t tmp3   = {0, 0};
    aisp_cpx_s32_t tmp4   = {0, 0};
    aisp_cpx_s32_t *Fout1 = NULL;
    aisp_cpx_s32_t *Fout2 = NULL;
    aisp_cpx_s32_t *Fout3 = NULL;
    aisp_cpx_s32_t *Fout4 = NULL;
    aisp_cpx_s16_t *tw2   = NULL;
    aisp_cpx_s16_t *tw3   = NULL;
    aisp_cpx_s16_t *tw4   = NULL;
    int iSize = M << 2;
    Fout1 = Fout;
    Fout2 = Fout1 + M;
    Fout3 = Fout2 + M;
    Fout4 = Fout3 + M;
    d_N   = N << 1;
    t_N   = (N << 1) + N;

    for (i = 0; i < N; i++)
    {
        tw2 = twiddles;
        tw3 = twiddles;
        tw4 = twiddles;

        for (j = 0; j < M; j++)
        {
            tmp1.real = Fout1[j].real;
            tmp1.imag = Fout1[j].imag;
            tmp2.real = PSHR((aisp_s64_t)Fout2[j].real * tw2->real - (aisp_s64_t)Fout2[j].imag * tw2->imag, 14);
            tmp2.imag = PSHR((aisp_s64_t)Fout2[j].imag * tw2->real + (aisp_s64_t)Fout2[j].real * tw2->imag, 14);
            tmp3.real = PSHR((aisp_s64_t)Fout3[j].real * tw3->real - (aisp_s64_t)Fout3[j].imag * tw3->imag, 14);
            tmp3.imag = PSHR((aisp_s64_t)Fout3[j].imag * tw3->real + (aisp_s64_t)Fout3[j].real * tw3->imag, 14);
            tmp4.real = PSHR((aisp_s64_t)Fout4[j].real * tw4->real - (aisp_s64_t)Fout4[j].imag * tw4->imag, 14);
            tmp4.imag = PSHR((aisp_s64_t)Fout4[j].imag * tw4->real + (aisp_s64_t)Fout4[j].real * tw4->imag, 14);
            Fout2[j].real = tmp1.real + tmp2.imag - tmp3.real - tmp4.imag;
            Fout2[j].imag = tmp1.imag - tmp2.real - tmp3.imag + tmp4.real;
            Fout3[j].real = tmp1.real - tmp2.real + tmp3.real - tmp4.real;
            Fout3[j].imag = tmp1.imag - tmp2.imag + tmp3.imag - tmp4.imag;
            Fout4[j].real = tmp1.real - tmp2.imag - tmp3.real + tmp4.imag;
            Fout4[j].imag = tmp1.imag + tmp2.real - tmp3.imag - tmp4.real;
            Fout1[j].real = tmp1.real + tmp2.real + tmp3.real + tmp4.real;
            Fout1[j].imag = tmp1.imag + tmp2.imag + tmp3.imag + tmp4.imag;
            tw2 += N;
            tw3 += d_N;
            tw4 += t_N;
        }

        Fout1 += iSize;
        Fout2 += iSize;
        Fout3 += iSize;
        Fout4 += iSize;
    }
}

static void AISP_TSL_ifft32_bfly4(aisp_cpx_s32_t *Fout, short M, short N, aisp_cpx_s16_t *twiddles)
{
    short i   = 0;
    short j   = 0;
    short d_N = 0;
    short t_N = 0;
    aisp_cpx_s32_t tmp1 = {0, 0};
    aisp_cpx_s32_t tmp2 = {0, 0};
    aisp_cpx_s32_t tmp3 = {0, 0};
    aisp_cpx_s32_t tmp4 = {0, 0};
    aisp_cpx_s32_t *Fout1 = NULL;
    aisp_cpx_s32_t *Fout2 = NULL;
    aisp_cpx_s32_t *Fout3 = NULL;
    aisp_cpx_s32_t *Fout4 = NULL;
    aisp_cpx_s16_t *tw2   = NULL;
    aisp_cpx_s16_t *tw3   = NULL;
    aisp_cpx_s16_t *tw4   = NULL;
    int iSize = M << 2;
    Fout1 = Fout;
    Fout2 = Fout1 + M;
    Fout3 = Fout2 + M;
    Fout4 = Fout3 + M;
    d_N   = N << 1;
    t_N   = (N << 1) + N;

    for (i = 0; i < N; i++)
    {
        tw2 = twiddles;
        tw3 = twiddles;
        tw4 = twiddles;

        for (j = 0; j < M; j++)
        {
            tmp1.real = PSHR(Fout1[j].real, 2);
            tmp1.imag = PSHR(Fout1[j].imag, 2);
            tmp2.real = PSHR((aisp_s64_t)Fout2[j].real * tw2->real + (aisp_s64_t)Fout2[j].imag * tw2->imag, 16);
            tmp2.imag = PSHR((aisp_s64_t)Fout2[j].imag * tw2->real - (aisp_s64_t)Fout2[j].real * tw2->imag, 16);
            tmp3.real = PSHR((aisp_s64_t)Fout3[j].real * tw3->real + (aisp_s64_t)Fout3[j].imag * tw3->imag, 16);
            tmp3.imag = PSHR((aisp_s64_t)Fout3[j].imag * tw3->real - (aisp_s64_t)Fout3[j].real * tw3->imag, 16);
            tmp4.real = PSHR((aisp_s64_t)Fout4[j].real * tw4->real + (aisp_s64_t)Fout4[j].imag * tw4->imag, 16);
            tmp4.imag = PSHR((aisp_s64_t)Fout4[j].imag * tw4->real - (aisp_s64_t)Fout4[j].real * tw4->imag, 16);
            Fout2[j].real = tmp1.real - tmp2.imag - tmp3.real + tmp4.imag;
            Fout2[j].imag = tmp1.imag + tmp2.real - tmp3.imag - tmp4.real;
            Fout3[j].real = tmp1.real - tmp2.real + tmp3.real - tmp4.real;
            Fout3[j].imag = tmp1.imag - tmp2.imag + tmp3.imag - tmp4.imag;
            Fout4[j].real = tmp1.real + tmp2.imag - tmp3.real - tmp4.imag;
            Fout4[j].imag = tmp1.imag - tmp2.real - tmp3.imag + tmp4.real;
            Fout1[j].real = tmp1.real + tmp2.real + tmp3.real + tmp4.real;
            Fout1[j].imag = tmp1.imag + tmp2.imag + tmp3.imag + tmp4.imag;
            tw2 += N;
            tw3 += d_N;
            tw4 += t_N;
        }

        Fout1 += iSize;
        Fout2 += iSize;
        Fout3 += iSize;
        Fout4 += iSize;
    }
}

static void AISP_TSL_fft32_core(aisp_fft_eng_t *pstFftEng, const aisp_cpx_s32_t *fin, aisp_cpx_s32_t *fout,
                                short inverse)
{
    short  i       = 0;
    short  n       = 0;
    short  m       = 0;
    short  ncfft   = 0;
    short  stages  = 0;
    short *idx_tab = NULL;
    ncfft   = pstFftEng->ncfft;
    idx_tab = pstFftEng->pIdx_tab;

    for (i = 0; i < ncfft; i++)
    {
        fout[i] = fin[idx_tab[i]];
    }

    stages = pstFftEng->width >> 1;
    n = ncfft;
    m = 1;

    if (inverse == 0)
    {
        for (i = 0; i < stages; i++)
        {
            n >>= 2;
            AISP_TSL_fft32_bfly4(fout, m, n, pstFftEng->twiddles);
            m <<= 2;
        }

        if (pstFftEng->stage_num == 2)
        {
            n >>= 1;
            AISP_TSL_fft32_bfly2(fout, m, n, pstFftEng->twiddles);
        }
    }
    else
        if (inverse == 1)
        {
            for (i = 0; i < stages; i++)
            {
                n >>= 2;
                AISP_TSL_ifft32_bfly4(fout, m, n, pstFftEng->twiddles);
                m <<= 2;
            }

            if (pstFftEng->stage_num == 2)
            {
                n >>= 1;
                AISP_TSL_ifft32_bfly2(fout, m, n, pstFftEng->twiddles);
            }
        }
}
#endif

extern void jl_fft_1024(short *in , int *out);
extern void jl_ifft_1024(int *in , short *out);

/*s16r_s32cpx*/
void AISP_TSL_fftr32(aisp_fft_eng_t *pstFftEng, const aisp_s16_t *time_data, aisp_cpx_s32_t *freq_data)
#if 1
{
    jl_fft_1024(time_data,(int *)freq_data);
}
#else
#ifdef USE_HIFI4_OPTIMIZE
{
    int32_t i = 0;
    int32_t ncfft;
    int32_t ncfftDouble = 0;
    int bexp ;
    int32_t time32[1024] MEM_ALIGN(8);
    ncfft   = pstFftEng->ncfft;
    ncfftDouble = ncfft << 1;

    if (ncfft == 512)
    {
        bexp = 10;
    }
    else
        if (ncfft == 256)
        {
            bexp = 9;
        }

    for (i = 0; i < ncfftDouble; i += 2)
    {
        time32[i] = time_data[i];
        time32[i + 1] = time_data[i + 1];
    }

    if (ncfft == 512)
    {
        fft_real32x16((int32_t *)freq_data, time32, bexp, h_fft_real_x16_1024);
    }
    else
        if (ncfft == 256)
        {
            fft_real32x16((int32_t *)freq_data, time32, bexp, h_fft_real_x16_512);
        }
}
#else
{
    short i                 = 0;
    short ncfft             = 0;
    short sNcfftHalf        = 0;
    short sIdx              = 0;
    aisp_cpx_s32_t  f1k     = {0, 0};
    aisp_cpx_s32_t  f2k     = {0, 0};
    aisp_cpx_s32_t  tmp     = {0, 0};
    aisp_cpx_s32_t *cpx_tmp = NULL;
    aisp_cpx_s32_t *tmp_buf = NULL;
    aisp_cpx_s16_t *tw1     = NULL;
    ncfft   = pstFftEng->ncfft;
    sNcfftHalf = ncfft >> 1;
    tw1     = pstFftEng->super_twiddles;
    cpx_tmp = pstFftEng->cpx_tmp;
    tmp_buf = pstFftEng->tmp_buf;

    for (i = 0; i < ncfft; i += 2)
    {
        cpx_tmp[i].real = time_data[0];
        cpx_tmp[i].imag = time_data[1];
        cpx_tmp[i + 1].real = time_data[2];
        cpx_tmp[i + 1].imag = time_data[3];
        time_data += 4;
    }

    AISP_TSL_fft32_core(pstFftEng, cpx_tmp, tmp_buf, 0);
    freq_data[0].real     = tmp_buf[0].real + tmp_buf[0].imag;
    freq_data[0].imag     = 0;
    freq_data[ncfft].real = tmp_buf[0].real - tmp_buf[0].imag;
    freq_data[ncfft].imag = 0;

    for (i = 1; i <= sNcfftHalf; i++)
    {
        tw1++;
        sIdx = ncfft - i;
#ifdef AISPEECH_FIXED
        f1k.real = PSHR(tmp_buf[i].real + tmp_buf[sIdx].real, 1);
        f1k.imag = PSHR(tmp_buf[i].imag - tmp_buf[sIdx].imag, 1);
        f2k.real = PSHR(tmp_buf[i].real - tmp_buf[sIdx].real, 1);
        f2k.imag = PSHR(tmp_buf[i].imag + tmp_buf[sIdx].imag, 1);
#else
        f1k.real = (tmp_buf[i].real + tmp_buf[sIdx].real) / 2;
        f1k.imag = (tmp_buf[i].imag - tmp_buf[sIdx].imag) / 2;
        f2k.real = (tmp_buf[i].real - tmp_buf[sIdx].real) / 2;
        f2k.imag = (tmp_buf[i].imag + tmp_buf[sIdx].imag) / 2;
#endif
        tmp.real = PSHR((aisp_s64_t)f2k.real * tw1->real - (aisp_s64_t)f2k.imag * tw1->imag, 14);
        tmp.imag = PSHR((aisp_s64_t)f2k.imag * tw1->real + (aisp_s64_t)f2k.real * tw1->imag, 14);
        freq_data[i].real = f1k.real + tmp.real;
        freq_data[i].imag = f1k.imag + tmp.imag;
        freq_data[sIdx].real = f1k.real - tmp.real;
        freq_data[sIdx].imag = tmp.imag - f1k.imag;
    }
}
#endif
#endif
/*cpxs32_s16*/
#if 1
int AISP_TSL_ifftr32(aisp_fft_eng_t *pstFftEng, aisp_cpx_s32_t *freq_data, aisp_s16_t *time_data)
{
    jl_ifft_1024((int *)freq_data, time_data);
    return 0;
}
#else
int AISP_TSL_ifftr32(aisp_fft_eng_t *pstFftEng, aisp_cpx_s32_t *freq_data, aisp_s16_t *time_data)
#ifdef USE_HIFI4_OPTIMIZE
{
    int32_t  i = 0;
    int32_t  freq32[2048] MEM_ALIGN(8);
    int32_t *pX = (int32_t *)freq_data;
    int32_t  time32[1024] MEM_ALIGN(8);
    int32_t  time32_max;
    int32_t  time32_min;
    int32_t  ncfft;
    int32_t  shift  = 0;
    int32_t  shift1 = 0;
    int32_t  ncfft_2;
    int32_t  ncfft_4;
    int32_t  offset = 0;
    int bexp;
    ncfft   = pstFftEng->ncfft;

    if (ncfft == 512)
    {
        bexp = 10;
    }
    else
        if (ncfft == 256)
        {
            bexp = 9;
        }

    ncfft_2 = ncfft << 1;
    ncfft_4 = ncfft_2 << 1;
    memcpy(freq32, pX, sizeof(int32_t)*ncfft_4);

    if (ncfft == 512)
    {
        shift1 = ifft_real32x16((int32_t *)time32, (int32_t *)freq32, bexp, h_ifft_real_x16_1024);
    }
    else
        if (ncfft == 256)
        {
            shift1 = ifft_real32x16((int32_t *)time32, (int32_t *)freq32, bexp, h_ifft_real_x16_512);
        }

    time32_max = vec_max32x32_fast(time32, ncfft_2);
    time32_min = vec_min32x32_fast(time32, ncfft_2);
    time32_min = -time32_min;
    time32_max = time32_max > time32_min ? time32_max : time32_min;
    int maxRag = 32767 * ncfft_2;

    while (time32_max > maxRag)
    {
        shift += 1;
        time32_max >>= 1;
    }

    offset = bexp + shift - shift1;

    for (i = 0; i < ncfft_2; i++)
    {
        time_data[i] = time32[i] >> offset;
    }

    return shift - shift1;
}
#else
{
    short i                 = 0;
    short ncfft             = 0;
    short sNfftHalf         = 0;
    short sIdx              = 0;
    int   shift             = 0;
    aisp_s32_t tData_max    = 0;
    aisp_s32_t tData_tmp    = 0;
    aisp_cpx_s32_t  f1k     = {0, 0};
    aisp_cpx_s32_t  f2k     = {0, 0};
    aisp_cpx_s32_t  tmp     = {0, 0};
    aisp_cpx_s32_t *cpx_tmp = NULL;
    aisp_cpx_s32_t *tmp_buf = NULL;
    aisp_cpx_s16_t *tw1     = NULL;
    ncfft   = pstFftEng->ncfft;
    cpx_tmp = pstFftEng->cpx_tmp;
    tmp_buf = pstFftEng->tmp_buf;
    tw1     = pstFftEng->super_twiddles;
    sNfftHalf = ncfft >> 1;
    cpx_tmp[0].real = PSHR(freq_data[0].real + freq_data[ncfft].real, 1);
    cpx_tmp[0].imag = PSHR(freq_data[0].real - freq_data[ncfft].real, 1);

    for (i = 1; i <= sNfftHalf; i++)
    {
        tw1++;
        sIdx = ncfft - i;
        f1k.real = PSHR(freq_data[i].real + freq_data[sIdx].real, 1);
        f1k.imag = PSHR(freq_data[i].imag - freq_data[sIdx].imag, 1);
        f2k.real = PSHR(freq_data[i].real - freq_data[sIdx].real, 1);
        f2k.imag = PSHR(freq_data[i].imag + freq_data[sIdx].imag, 1);
        tmp.real = PSHR((aisp_s64_t)f2k.real * tw1->real + (aisp_s64_t)f2k.imag * tw1->imag, 14);
        tmp.imag = PSHR((aisp_s64_t)f2k.imag * tw1->real - (aisp_s64_t)f2k.real * tw1->imag, 14);
        cpx_tmp[i].real = f1k.real + tmp.real;
        cpx_tmp[i].imag = f1k.imag + tmp.imag;
        cpx_tmp[ncfft - i].real = f1k.real - tmp.real;
        cpx_tmp[ncfft - i].imag = tmp.imag - f1k.imag;
    }

    AISP_TSL_fft32_core(pstFftEng, cpx_tmp, tmp_buf, 1);

    for (i = 0; i < ncfft; i++)
    {
        tData_tmp = tmp_buf[i].real > 0 ? tmp_buf[i].real : (-tmp_buf[i].real);

        if (tData_max < tData_tmp)
        {
            tData_max = tData_tmp;
        }

        tData_tmp = tmp_buf[i].imag > 0 ? tmp_buf[i].imag : (-tmp_buf[i].imag);

        if (tData_max < tData_tmp)
        {
            tData_max = tData_tmp;
        }
    }

    while (tData_max > 32767)
    {
        tData_max = PSHR(tData_max, 1);
        shift += 1;
    }

    for (i = 0; i < ncfft; i += 2)
    {
        time_data[0] = PSHR(tmp_buf[i].real, shift);
        time_data[1] = PSHR(tmp_buf[i].imag, shift);
        time_data[2] = PSHR(tmp_buf[i + 1].real, shift);
        time_data[3] = PSHR(tmp_buf[i + 1].imag, shift);
        time_data += 4;
    }

#ifdef AISP_TSL_INFO

    if (shift > 0)
    {
        printf("ifft_data overflowed!!!, divided by 2\n");
    }

#endif
    return shift;
}
#endif
#endif
#ifndef JL_AEC_OPTIMIZATION_FFT

void AISP_TSL_fft_destroy(aisp_fft_eng_t *pstFftEng)
{
    if (pstFftEng->pIdx_tab)
    {
        AISP_MEM_FREE(pstFftEng->pIdx_tab);
        pstFftEng->pIdx_tab = NULL;
    }

#ifndef USE_HIFI4_OPTIMIZE

    if (pstFftEng->cpx_tmp)
    {
        AISP_MEM_FREE(pstFftEng->cpx_tmp);
        pstFftEng->cpx_tmp = NULL;
    }

    if (pstFftEng->tmp_buf)
    {
        AISP_MEM_FREE(pstFftEng->tmp_buf);
        pstFftEng->tmp_buf = NULL;
    }

#endif

    if (pstFftEng)
    {
        AISP_MEM_FREE(pstFftEng);
        pstFftEng = NULL;
    }
}
#endif
