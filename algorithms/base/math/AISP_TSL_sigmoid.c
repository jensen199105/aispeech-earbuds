/************************************************************
  Copyright (C), AISpeechTech. Co., Ltd.

  FileName   : AISP_TSL_sigmoid.c
  Project    :
  Module     :
  Version    :
  Date       : 2019/06/20
  Author     : Youhai.Jiang
  Document   :
  Description:

  Function List :

  History :
  <author>      <time>            <version >        <desc>
  Youhai.Jiang  2019/06/20         1.00              Create

************************************************************/

#include "AISP_TSL_common.h"
#include "AISP_TSL_sigmoid.h"

/*
 * The range of input is (-20, 20), each elememt is intepreted as Q31. Step is 0.03125.
 */
const unsigned int sigmoid_pol_table[641] =
{
    0x40000000,    0x40fffaab,    0x41ffd55a,    0x42ff7020,    0x43feab33,    0x44fd66f5,    0x45fb8409,    0x46f8e361,
    0x47f5664b,    0x48f0ee83,    0x49eb5e3e,    0x4ae49839,    0x4bdc7fc8,    0x4cd2f8df,    0x4dc7e821,    0x4ebb32e8,
    0x4facbf53,    0x509c744f,    0x518a399e,    0x5275f7e2,    0x535f98a1,    0x54470650,    0x552c2c56,    0x560ef712,
    0x56ef53df,    0x57cd3116,    0x58a87e15,    0x59812b3b,    0x5a5729ee,    0x5b2a6c99,    0x5bfae6ac,    0x5cc88c99,
    0x5d9353d7,    0x5e5b32dc,    0x5f20211a,    0x5fe216fd,    0x60a10de6,    0x615d0026,    0x6215e8fc,    0x62cbc48a,
    0x637e8fd5,    0x642e48bb,    0x64daedee,    0x65847eed,    0x662afbfd,    0x66ce6622,    0x676ebf18,    0x680c0949,
    0x68a647cb,    0x693d7e51,    0x69d1b12b,    0x6a62e538,    0x6af11fe2,    0x6b7c6714,    0x6c04c135,    0x6c8a351f,
    0x6d0cca17,    0x6d8c87c7,    0x6e097637,    0x6e839dc4,    0x6efb071c,    0x6f6fbb36,    0x6fe1c34a,    0x705128cd,
    0x70bdf56a,    0x712832fe,    0x718feb8d,    0x71f52945,    0x7257f66e,    0x72b85d70,    0x731668c7,    0x73722301,
    0x73cb96b7,    0x7422ce8f,    0x7477d531,    0x74cab546,    0x751b7978,    0x756a2c69,    0x75b6d8b2,    0x760188e1,
    0x764a4777,    0x76911ee2,    0x76d6197e,    0x77194191,    0x775aa149,    0x779a42bc,    0x77d82fe4,    0x7814729c,
    0x784f14a5,    0x78881f9d,    0x78bf9d03,    0x78f59633,    0x792a1467,    0x795d20b4,    0x798ec40e,    0x79bf073f,
    0x79edf2f1,    0x7a1b8fa3,    0x7a47e5b2,    0x7a72fd50,    0x7a9cde8d,    0x7ac5914d,    0x7aed1d51,    0x7b138a32,
    0x7b38df60,    0x7b5d2426,    0x7b805fa9,    0x7ba298e5,    0x7bc3d6b2,    0x7be41fc1,    0x7c037a9d,    0x7c21edac,
    0x7c3f7f30,    0x7c5c3544,    0x7c7815e1,    0x7c9326dd,    0x7cad6de8,    0x7cc6f091,    0x7cdfb445,    0x7cf7be50,
    0x7d0f13da,    0x7d25b9ed,    0x7d3bb572,    0x7d510b34,    0x7d65bfdc,    0x7d79d7f7,    0x7d8d57f4,    0x7da04424,
    0x7db2a0bc,    0x7dc471d5,    0x7dd5bb6c,    0x7de68164,    0x7df6c784,    0x7e06917b,    0x7e15e2dd,    0x7e24bf28,
    0x7e3329bf,    0x7e4125ef,    0x7e4eb6ef,    0x7e5bdfdc,    0x7e68a3c1,    0x7e750592,    0x7e81082d,    0x7e8cae5d,
    0x7e97fad8,    0x7ea2f043,    0x7ead912d,    0x7eb7e015,    0x7ec1df66,    0x7ecb917a,    0x7ed4f89b,    0x7ede1702,
    0x7ee6eed6,    0x7eef8232,    0x7ef7d31d,    0x7effe393,    0x7f07b57e,    0x7f0f4abe,    0x7f16a520,    0x7f1dc669,
    0x7f24b04c,    0x7f2b6473,    0x7f31e47a,    0x7f3831f1,    0x7f3e4e5c,    0x7f443b35,    0x7f49f9ea,    0x7f4f8bde,
    0x7f54f269,    0x7f5a2edc,    0x7f5f4279,    0x7f642e7e,    0x7f68f41b,    0x7f6d947a,    0x7f7210ba,    0x7f7669f4,
    0x7f7aa136,    0x7f7eb787,    0x7f82ade8,    0x7f86854f,    0x7f8a3ead,    0x7f8ddaec,    0x7f915aec,    0x7f94bf8a,
    0x7f98099b,    0x7f9b39ee,    0x7f9e5149,    0x7fa15070,    0x7fa4381f,    0x7fa7090d,    0x7fa9c3eb,    0x7fac6965,
    0x7faefa22,    0x7fb176c4,    0x7fb3dfe6,    0x7fb63623,    0x7fb87a0c,    0x7fbaac32,    0x7fbccd1e,    0x7fbedd57,
    0x7fc0dd61,    0x7fc2cdb9,    0x7fc4aed9,    0x7fc6813a,    0x7fc8454e,    0x7fc9fb86,    0x7fcba44d,    0x7fcd400d,
    0x7fcecf2c,    0x7fd0520c,    0x7fd1c90e,    0x7fd3348f,    0x7fd494e8,    0x7fd5ea71,    0x7fd7357f,    0x7fd87664,
    0x7fd9ad70,    0x7fdadaef,    0x7fdbff2d,    0x7fdd1a72,    0x7fde2d05,    0x7fdf3729,    0x7fe03922,    0x7fe1332e,
    0x7fe2258c,    0x7fe31079,    0x7fe3f42f,    0x7fe4d0e7,    0x7fe5a6d7,    0x7fe67634,    0x7fe73f33,    0x7fe80205,
    0x7fe8beda,    0x7fe975e3,    0x7fea274c,    0x7fead341,    0x7feb79ee,    0x7fec1b7b,    0x7fecb812,    0x7fed4fd8,
    0x7fede2f5,    0x7fee718c,    0x7feefbc1,    0x7fef81b7,    0x7ff0038f,    0x7ff08169,    0x7ff0fb65,    0x7ff171a0,
    0x7ff1e43a,    0x7ff2534d,    0x7ff2bef7,    0x7ff32751,    0x7ff38c75,    0x7ff3ee7e,    0x7ff44d83,    0x7ff4a99d,
    0x7ff502e1,    0x7ff55967,    0x7ff5ad44,    0x7ff5fe8c,    0x7ff64d55,    0x7ff699b2,    0x7ff6e3b5,    0x7ff72b72,
    0x7ff770fa,    0x7ff7b45f,    0x7ff7f5b1,    0x7ff83501,    0x7ff8725f,    0x7ff8add9,    0x7ff8e77f,    0x7ff91f60,
    0x7ff95588,    0x7ff98a06,    0x7ff9bce7,    0x7ff9ee37,    0x7ffa1e03,    0x7ffa4c56,    0x7ffa793d,    0x7ffaa4c2,
    0x7ffacef1,    0x7ffaf7d3,    0x7ffb1f74,    0x7ffb45dc,    0x7ffb6b16,    0x7ffb8f2b,    0x7ffbb224,    0x7ffbd40a,
    0x7ffbf4e4,    0x7ffc14bc,    0x7ffc3399,    0x7ffc5183,    0x7ffc6e82,    0x7ffc8a9c,    0x7ffca5d9,    0x7ffcc03f,
    0x7ffcd9d6,    0x7ffcf2a3,    0x7ffd0aac,    0x7ffd21f9,    0x7ffd388e,    0x7ffd4e71,    0x7ffd63a8,    0x7ffd7837,
    0x7ffd8c25,    0x7ffd9f76,    0x7ffdb22e,    0x7ffdc454,    0x7ffdd5ea,    0x7ffde6f6,    0x7ffdf77c,    0x7ffe077f,
    0x7ffe1704,    0x7ffe2610,    0x7ffe34a4,    0x7ffe42c6,    0x7ffe5079,    0x7ffe5dbf,    0x7ffe6a9d,    0x7ffe7716,
    0x7ffe832d,    0x7ffe8ee4,    0x7ffe9a3f,    0x7ffea541,    0x7ffeafec,    0x7ffeba43,    0x7ffec448,    0x7ffecdff,
    0x7ffed769,    0x7ffee089,    0x7ffee961,    0x7ffef1f3,    0x7ffefa42,    0x7fff0250,    0x7fff0a1e,    0x7fff11af,
    0x7fff1904,    0x7fff201f,    0x7fff2702,    0x7fff2daf,    0x7fff3428,    0x7fff3a6d,    0x7fff4081,    0x7fff4665,
    0x7fff4c1b,    0x7fff51a4,    0x7fff5701,    0x7fff5c34,    0x7fff613f,    0x7fff6621,    0x7fff6add,    0x7fff6f73,
    0x7fff73e6,    0x7fff7835,    0x7fff7c63,    0x7fff8070,    0x7fff845c,    0x7fff882a,    0x7fff8bda,    0x7fff8f6d,
    0x7fff92e3,    0x7fff963f,    0x7fff9980,    0x7fff9ca7,    0x7fff9fb6,    0x7fffa2ac,    0x7fffa58b,    0x7fffa853,
    0x7fffab06,    0x7fffada3,    0x7fffb02c,    0x7fffb2a1,    0x7fffb502,    0x7fffb751,    0x7fffb98d,    0x7fffbbb8,
    0x7fffbdd2,    0x7fffbfdb,    0x7fffc1d4,    0x7fffc3be,    0x7fffc599,    0x7fffc765,    0x7fffc923,    0x7fffcad3,
    0x7fffcc75,    0x7fffce0b,    0x7fffcf95,    0x7fffd112,    0x7fffd284,    0x7fffd3ea,    0x7fffd545,    0x7fffd696,
    0x7fffd7dc,    0x7fffd918,    0x7fffda4b,    0x7fffdb74,    0x7fffdc94,    0x7fffddab,    0x7fffdeb9,    0x7fffdfbf,
    0x7fffe0bd,    0x7fffe1b3,    0x7fffe2a2,    0x7fffe389,    0x7fffe469,    0x7fffe543,    0x7fffe615,    0x7fffe6e1,
    0x7fffe7a7,    0x7fffe867,    0x7fffe921,    0x7fffe9d5,    0x7fffea84,    0x7fffeb2d,    0x7fffebd1,    0x7fffec70,
    0x7fffed0a,    0x7fffed9f,    0x7fffee30,    0x7fffeebc,    0x7fffef44,    0x7fffefc8,    0x7ffff048,    0x7ffff0c4,
    0x7ffff13c,    0x7ffff1b0,    0x7ffff221,    0x7ffff28e,    0x7ffff2f8,    0x7ffff35f,    0x7ffff3c2,    0x7ffff422,
    0x7ffff480,    0x7ffff4da,    0x7ffff532,    0x7ffff587,    0x7ffff5da,    0x7ffff62a,    0x7ffff677,    0x7ffff6c2,
    0x7ffff70b,    0x7ffff752,    0x7ffff796,    0x7ffff7d8,    0x7ffff819,    0x7ffff857,    0x7ffff893,    0x7ffff8ce,
    0x7ffff906,    0x7ffff93d,    0x7ffff972,    0x7ffff9a6,    0x7ffff9d8,    0x7ffffa09,    0x7ffffa38,    0x7ffffa65,
    0x7ffffa91,    0x7ffffabc,    0x7ffffae6,    0x7ffffb0e,    0x7ffffb35,    0x7ffffb5a,    0x7ffffb7f,    0x7ffffba3,
    0x7ffffbc5,    0x7ffffbe6,    0x7ffffc07,    0x7ffffc26,    0x7ffffc44,    0x7ffffc62,    0x7ffffc7e,    0x7ffffc9a,
    0x7ffffcb4,    0x7ffffcce,    0x7ffffce8,    0x7ffffd00,    0x7ffffd18,    0x7ffffd2f,    0x7ffffd45,    0x7ffffd5a,
    0x7ffffd6f,    0x7ffffd83,    0x7ffffd97,    0x7ffffdaa,    0x7ffffdbc,    0x7ffffdce,    0x7ffffddf,    0x7ffffdf0,
    0x7ffffe00,    0x7ffffe10,    0x7ffffe1f,    0x7ffffe2e,    0x7ffffe3d,    0x7ffffe4a,    0x7ffffe58,    0x7ffffe65,
    0x7ffffe72,    0x7ffffe7e,    0x7ffffe8a,    0x7ffffe95,    0x7ffffea0,    0x7ffffeab,    0x7ffffeb6,    0x7ffffec0,
    0x7ffffeca,    0x7ffffed3,    0x7ffffedc,    0x7ffffee5,    0x7ffffeee,    0x7ffffef7,    0x7ffffeff,    0x7fffff07,
    0x7fffff0e,    0x7fffff16,    0x7fffff1d,    0x7fffff24,    0x7fffff2b,    0x7fffff31,    0x7fffff38,    0x7fffff3e,
    0x7fffff44,    0x7fffff4a,    0x7fffff4f,    0x7fffff55,    0x7fffff5a,    0x7fffff5f,    0x7fffff64,    0x7fffff69,
    0x7fffff6d,    0x7fffff72,    0x7fffff76,    0x7fffff7b,    0x7fffff7f,    0x7fffff83,    0x7fffff86,    0x7fffff8a,
    0x7fffff8e,    0x7fffff91,    0x7fffff95,    0x7fffff98,    0x7fffff9b,    0x7fffff9e,    0x7fffffa1,    0x7fffffa4,
    0x7fffffa7,    0x7fffffaa,    0x7fffffac,    0x7fffffaf,    0x7fffffb2,    0x7fffffb4,    0x7fffffb6,    0x7fffffb9,
    0x7fffffbb,    0x7fffffbd,    0x7fffffbf,    0x7fffffc1,    0x7fffffc3,    0x7fffffc5,    0x7fffffc7,    0x7fffffc8,
    0x7fffffca,    0x7fffffcc,    0x7fffffcd,    0x7fffffcf,    0x7fffffd0,    0x7fffffd2,    0x7fffffd3,    0x7fffffd5,
    0x7fffffd6,    0x7fffffd7,    0x7fffffd9,    0x7fffffda,    0x7fffffdb,    0x7fffffdc,    0x7fffffdd,    0x7fffffde,
    0x7fffffdf,    0x7fffffe0,    0x7fffffe1,    0x7fffffe2,    0x7fffffe3,    0x7fffffe4,    0x7fffffe5,    0x7fffffe6,
    0x7fffffe7,    0x7fffffe7,    0x7fffffe8,    0x7fffffe9,    0x7fffffea,    0x7fffffea,    0x7fffffeb,    0x7fffffec,
    0x7fffffec,    0x7fffffed,    0x7fffffed,    0x7fffffee,    0x7fffffee,    0x7fffffef,    0x7ffffff0,    0x7ffffff0,
    0x7ffffff1,    0x7ffffff1,    0x7ffffff1,    0x7ffffff2,    0x7ffffff2,    0x7ffffff3,    0x7ffffff3,    0x7ffffff4,
    0x7ffffff4,    0x7ffffff4,    0x7ffffff5,    0x7ffffff5,    0x7ffffff5,    0x7ffffff6,    0x7ffffff6,    0x7ffffff6,
    0x7ffffff7,    0x7ffffff7,    0x7ffffff7,    0x7ffffff7,    0x7ffffff8,    0x7ffffff8,    0x7ffffff8,    0x7ffffff8,
    0x7ffffff9,    0x7ffffff9,    0x7ffffff9,    0x7ffffff9,    0x7ffffffa,    0x7ffffffa,    0x7ffffffa,    0x7ffffffa,
    0x7ffffffa,    0x7ffffffa,    0x7ffffffb,    0x7ffffffb,    0x7ffffffb,    0x7ffffffb,    0x7ffffffb,    0x7ffffffb,
    0x7ffffffc
};

/*
 * Each element is intepreted as Q31, error is the max diff between sigmoid and linear.
 */
const unsigned short sigmoid_error_table[640] =
{
    0x20d,     0x604,     0x9fe,     0xdf4,     0x11e3,    0x15ca,    0x19a6,    0x1d76,
    0x2137,    0x24e8,    0x2887,    0x2c13,    0x2f89,    0x32ea,    0x3632,    0x3962,
    0x3c77,    0x3f71,    0x424f,    0x450f,    0x47b1,    0x4a35,    0x4c9a,    0x4ede,
    0x5103,    0x5307,    0x54eb,    0x56ae,    0x5850,    0x59d2,    0x5b33,    0x5c75,
    0x5d96,    0x5e98,    0x5f7b,    0x6040,    0x60e7,    0x6170,    0x61de,    0x6230,
    0x6266,    0x6283,    0x6287,    0x6272,    0x6246,    0x6203,    0x61ab,    0x613e,
    0x60be,    0x602b,    0x5f86,    0x5ed1,    0x5e0b,    0x5d37,    0x5c55,    0x5b66,
    0x5a6b,    0x5964,    0x5853,    0x5739,    0x5616,    0x54eb,    0x53b9,    0x5280,
    0x5142,    0x4fff,    0x4eb7,    0x4d6c,    0x4c1e,    0x4acd,    0x497a,    0x4826,
    0x46d1,    0x457c,    0x4427,    0x42d2,    0x417e,    0x402c,    0x3edb,    0x3d8c,
    0x3c3f,    0x3af5,    0x39ae,    0x3869,    0x3728,    0x35eb,    0x34b1,    0x337b,
    0x3249,    0x311c,    0x2ff2,    0x2ecd,    0x2dad,    0x2c91,    0x2b7a,    0x2a67,
    0x2959,    0x2850,    0x274c,    0x264d,    0x2553,    0x245d,    0x236d,    0x2281,
    0x219a,    0x20b8,    0x1fdb,    0x1f02,    0x1e2e,    0x1d5f,    0x1c95,    0x1bcf,
    0x1b0e,    0x1a51,    0x1998,    0x18e4,    0x1835,    0x1789,    0x16e2,    0x163f,
    0x15a0,    0x1504,    0x146d,    0x13da,    0x134a,    0x12be,    0x1236,    0x11b1,
    0x112f,    0x10b1,    0x1037,    0xfbf,     0xf4b,     0xeda,     0xe6c,     0xe01,
    0xd99,     0xd34,     0xcd1,     0xc71,     0xc14,     0xbba,     0xb62,     0xb0c,
    0xab9,     0xa68,     0xa19,     0x9cd,     0x983,     0x93a,     0x8f4,     0x8b0,
    0x86e,     0x82e,     0x7f0,     0x7b3,     0x778,     0x73f,     0x708,     0x6d2,
    0x69e,     0x66b,     0x639,     0x60a,     0x5db,     0x5ae,     0x582,     0x558,
    0x52f,     0x507,     0x4e0,     0x4ba,     0x496,     0x472,     0x450,     0x42e,
    0x40e,     0x3ee,     0x3d0,     0x3b2,     0x396,     0x37a,     0x35f,     0x345,
    0x32b,     0x313,     0x2fb,     0x2e3,     0x2cd,     0x2b7,     0x2a2,     0x28d,
    0x27a,     0x266,     0x253,     0x241,     0x230,     0x21f,     0x20e,     0x1fe,
    0x1ee,     0x1df,     0x1d1,     0x1c3,     0x1b5,     0x1a7,     0x19a,     0x18e,
    0x182,     0x176,     0x16a,     0x15f,     0x155,     0x14a,     0x140,     0x136,
    0x12d,     0x124,     0x11b,     0x112,     0x10a,     0x101,     0xfa,      0xf2,
    0xeb,      0xe3,      0xdc,      0xd6,      0xcf,      0xc9,      0xc3,      0xbd,
    0xb7,      0xb1,      0xac,      0xa6,      0xa1,      0x9c,      0x98,      0x93,
    0x8e,      0x8a,      0x86,      0x82,      0x7e,      0x7a,      0x76,      0x72,
    0x6f,      0x6c,      0x68,      0x65,      0x62,      0x5f,      0x5c,      0x59,
    0x56,      0x54,      0x51,      0x4f,      0x4c,      0x4a,      0x48,      0x45,
    0x43,      0x41,      0x3f,      0x3d,      0x3b,      0x3a,      0x38,      0x36,
    0x34,      0x33,      0x31,      0x30,      0x2e,      0x2d,      0x2c,      0x2a,
    0x29,      0x28,      0x26,      0x25,      0x24,      0x23,      0x22,      0x21,
    0x20,      0x1f,      0x1e,      0x1d,      0x1c,      0x1b,      0x1a,      0x1a,
    0x19,      0x18,      0x17,      0x17,      0x16,      0x15,      0x15,      0x14,
    0x13,      0x13,      0x12,      0x12,      0x11,      0x11,      0x10,      0x10,
    0xf,       0xf,       0xe,       0xe,       0xd,       0xd,       0xc,       0xc,
    0xc,       0xb,       0xb,       0xb,       0xa,       0xa,       0xa,       0x9,
    0x9,       0x9,       0x9,       0x8,       0x8,       0x8,       0x8,       0x7,
    0x7,       0x7,       0x7,       0x6,       0x6,       0x6,       0x6,       0x6,
    0x6,       0x5,       0x5,       0x5,       0x5,       0x5,       0x5,       0x4,
    0x4,       0x4,       0x4,       0x4,       0x4,       0x4,       0x4,       0x3,
    0x3,       0x3,       0x3,       0x3,       0x3,       0x3,       0x3,       0x3,
    0x3,       0x3,       0x2,       0x2,       0x2,       0x2,       0x2,       0x2,
    0x2,       0x2,       0x2,       0x2,       0x2,       0x2,       0x2,       0x2,
    0x2,       0x2,       0x1,       0x1,       0x1,       0x1,       0x1,       0x1,
    0x1,       0x1,       0x1,       0x1,       0x1,       0x1,       0x1,       0x1,
    0x1,       0x1,       0x1,       0x1,       0x1,       0x1,       0x1,       0x1,
    0x1,       0x1,       0x1,       0x1,       0x1,       0x1,       0x1,       0x1,
    0x1,       0x1,       0x1,       0x1,       0x1,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
    0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,       0x0,
};

/**
 * @brief    Calculate the fixed-point sigmoid where x > 0.
 * @note     The absolute value of input must be less than(<) 20.
 * @param    x    input, Q24 data type
 * @return   y    output, Q24 data type
 *
 * @history
 *           2018.07.11, chao.xu create
 **/
S32 AISP_TSL_sigmoid_xW32Q24_yW32Q24(S32 x)
{
    S32 abs_x, group, half, quarter, slope;
    S32 error;
    S32 y;
    abs_x   = AISP_TSL_ABS(x);
    half    = abs_x & 0x7ffff;
    quarter = abs_x & 0x3ffff;

    if (half < 0x40000)
    {
        quarter = 0x40000 - quarter;
    }

    group = abs_x >> 19;
    error = sigmoid_error_table[group];
    slope = sigmoid_pol_table[group + 1] - sigmoid_pol_table[group];
    y     = sigmoid_pol_table[group] + error;
    y    += ((long long)slope * half) >> 19;
    y    -= ((long long)error * quarter * quarter) >> 36;    /* second order approximation y = m(1 - x*x) */
    y   >>= 7;

    if (x < 0)
    {
        y = 0x01000000 - y;
    }

    return y;
}

/**
 * @brief     Calculate the function exp(-x)
 * @note    The absolute value of input must be less than(<) 20.
 * @param    x    input, Q24 data type
 *
 * @return    exp(-x), intepreted as q_out
 * @history
 *             2018.07.11, chao.xu create
 */
int AISP_TSL_exp_minus_xW32Q24_yW32(int x, int q_out)
{
    int abs_x, group, half, quarter, slope;
    int error;
    int y;
    long long result;
    abs_x   = AISP_TSL_ABS(x);
    group   = abs_x >> 19;
    half    = abs_x & 0x7ffff;
    quarter = abs_x & 0x3ffff;

    if (half < 0x40000)
    {
        quarter = 0x40000 - quarter;
    }

    error = sigmoid_error_table[group];
    slope = sigmoid_pol_table[group + 1] - sigmoid_pol_table[group];
    y        = sigmoid_pol_table[group] + error;
    y    += ((long long)slope * half) >> 19;
    y    -= ((long long)error * quarter * quarter) >> 36;    /* second order approximation y = m(1 - x*x) */
    result = (((long long)1 << (31 + q_out)) + (y >> 1)) / y - ((long long)1 << q_out); /* Q31 1/y > 1.0 */
    return ((int)result);
}

int AISP_TSL_exp_plus_xW32Q24_yW32(int x, int q_out)
{
    int ii;
    int g_values[] =
    {
        16777216,    16777218,    16777220,    16777224,    16777232,    16777248,    16777280,    16777344,
        16777472,    16777728,    16778240,    16779264,    16781313,    16785410,    16793608,    16810016,
        16842880,    16908801,    17041419,    17309782,    17859253,    19011076,    21542372,    27660953,
        45605201,   123967790,   916004956
    };
    int abs_x   = AISP_TSL_ABS(x);
    int y = 1 << q_out;

    if (abs_x == 0)
    {
        return y;
    }

    //81403559=log(0x7FFFFFFF/(1<<24))*(1<<24)
    if (abs_x >= 81403559)
    {
        return  0x7FFFFFFF;
    }

    for (ii = 0; ii < 27; ii++)
    {
        if (abs_x & (1 << ii))
        {
            y = ((long long)y * g_values[ii]) >> 24;
        }
    }

    return y;
}

int AISP_TSL_exp_xW32Q24_yW32(int x, int q_out)
{
    if (0 > x)
    {
        return AISP_TSL_exp_minus_xW32Q24_yW32(x, q_out);
    }
    else
        if (0 < x)
        {
            return AISP_TSL_exp_plus_xW32Q24_yW32(x, q_out);
        }
        else
        {
            return 1 << q_out;
        }
}
